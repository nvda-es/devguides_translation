# -*- coding: utf-8 -*-
documentation = [
_(u"""<!-- A note to translators:"""),
_(u"""If you are publishing a translated version of this file off-github, the current table of contents likely won't work."""),
_(u"""It includes \"user-content-\" at the start of each relative link, because of Github's processing."""),
_(u"""You will have to remove all of those."""),
"",_(u"""It may be better to delete this table of contents entirely, and generate a clean one, either by:"""),
_(u"""Deleting everything between the TOC start and end comments, and replacing the whole thing with:"""),
_(u"""[TOC]"""),
_(u"""Assuming your translation tool supports that markdown extension; or:"""),
_(u"""downloading the PERL script we use to generate the table of contents, and running it with the """),
_(u"""$relativeLinkPreface variable in the CONFIGURATION section set to the empty string \"\"."""),
_(u"""You can download the PERL script at:"""),
_(u"""https://github.com/XLTechie/pubtools/raw/master/markdowntoc.pl"""),
_(u"""If you take this latter option, you may consider generating the table of contents after the translation, instead of before. This may or may not work."""),
_(u"""Please report your experiences with translations, and we will do our best to adjust things to make it easier."""),
_(u"""-->"""),
"",_(u"""[//]: # (Links for use elsewhere in the document)"""),
_(u"""[Git]: https://www.git-scm.com"""),
_(u"""[GitHub]: https://www.github.com/"""),
_(u"""[BitBucket]: https://bitbucket.org/"""),
_(u"""[NVDA GitHub page]: https://github.com/nvaccess/nvda"""),
_(u"""[NVDA Developer Guide]: https://www.nvaccess.org/files/nvda/documentation/developerGuide.html"""),
_(u"""[Design Overview]: https://github.com/nvaccess/nvda/wiki/DesignOverview"""),
_(u"""[NVDA Community Add-ons web site]: https://addons.nvda-project.org"""),
_(u"""[add-on template]: https://github.com/nvdaaddons/AddonTemplate/archive/master.zip"""),
_(u"""[Python Console]: <https://www.nvaccess.org/files/nvda/documentation/developerGuide.html#PythonConsole> (Python Console in NVDA Developer Guide)"""),
_(u"""[Using Win32 API]: http://www.zlotowicz.pl/nvda/winapi.mdwn (Using Win32 API in your add-on)"""),
_(u"""[Git Bash]: https://www.atlassian.com/git/tutorials/git-bash"""),
_(u"""[Git for Cygwin]: https://stackoverflow.com/questions/33006007/how-to-install-git-for-cygwin"""),
_(u"""[TortoiseGit]: https://tortoisegit.org/"""),
_(u"""[WSL]: https://docs.microsoft.com/en-us/windows/wsl/install-win10 (Windows Subsystem for Linux)"""),
"",_(u"""# NVDA Add-on Development Guide"""),
"",_(u"""Latest version: October 2020 for NVDA 2020.3"""),
"",_(u"""---"""),
"",_(u"""[//]: # (Place this line where you want the table of contents to start)"""),
_(u"""[Table Of Contents]: <#user-content-table-of-contents> (TOC)"""),
"",_(u"""# **TABLE OF CONTENTS**"""),
"",_(u"""*A note to screen reader users:* to return to this table of contents, use your heading level 1 browse mode command in the reverse direction."""),
"",_(u"""- [Authors, Contributions, and Copyright](#user-content-authors-contributions-and-copyright)"""),
_(u"""- [Introduction](#user-content-introduction)"""),
_(u"""- [Audience](#user-content-audience)"""),
_(u"""    - [Special note on Python version](#user-content-special-note-on-python-version)"""),
_(u"""    - [A special note for scripters of other screen readers](#user-content-a-special-note-for-scripters-of-other-screen-readers)"""),
_(u"""    - [A special note about Windows Store version of NVDA](#user-content-a-special-note-about-windows-store-version-of-nvda)"""),
_(u"""    - [A very important note about migrating custom extension code to development scratchpad](#user-content-a-very-important-note-about-migrating-custom-extension-code-to-development-scratchpad)"""),
_(u"""- [Add-on Basics](#user-content-add-on-basics)"""),
_(u"""    - [What are Add-ons?](#user-content-what-are-add-ons)"""),
_(u"""    - [What Are Add-on Modules?](#user-content-what-are-add-on-modules)"""),
_(u"""    - [What Are Add-on Packages?](#user-content-what-are-add-on-packages)"""),
_(u"""    - [Installing NVDA Add-ons](#user-content-installing-nvda-add-ons)"""),
_(u"""- [Setting Up Your Add-on Development Environment](#user-content-setting-up-your-add-on-development-environment)"""),
_(u"""    - [Meet System Requirements](#user-content-meet-system-requirements)"""),
_(u"""    - [Add-on Development Folder Structure](#user-content-add-on-development-folder-structure)"""),
_(u"""    - [Add-on folder structure](#user-content-add-on-folder-structure)"""),
_(u"""    - [Packaging add-ons](#user-content-packaging-add-ons)"""),
_(u"""- [Getting started: Hands-on examples](#user-content-getting-started-hands-on-examples)"""),
_(u"""    - [How add-on code is organized](#user-content-how-add-on-code-is-organized)"""),
_(u"""    - [Running your add-on in this example chapter](#user-content-running-your-add-on-in-this-example-chapter)"""),
_(u"""    - [Example 1: Hear a tone when pressing NVDA+A](#user-content-example-1-hear-a-tone-when-pressing-nvdaa)"""),
_(u"""    - [Example 1 code explanation](#user-content-example-1-code-explanation)"""),
_(u"""    - [I don't understand those above terms](#user-content-i-dont-understand-those-above-terms)"""),
_(u"""    - [Example 2: Generate a tone when switching to Notepad](#user-content-example-2-generate-a-tone-when-switching-to-notepad)"""),
_(u"""    - [Example 2 code explanation](#user-content-example-2-code-explanation)"""),
_(u"""    - [More new terms please](#user-content-more-new-terms-please)"""),
_(u"""    - [A few tips for beginners](#user-content-a-few-tips-for-beginners)"""),
_(u"""- [Useful modules from NVDA core](#user-content-useful-modules-from-nvda-core)"""),
_(u"""    - [List of useful NVDA core modules and methods](#user-content-list-of-useful-nvda-core-modules-and-methods)"""),
_(u"""    - [Some real-life examples](#user-content-some-real-life-examples)"""),
_(u"""        - [Example 1: am I on the right app where the focus is located?](#user-content-example-1-am-i-on-the-right-app-where-the-focus-is-located)"""),
_(u"""        - [Example 2: Display a message in a browse mode document](#user-content-example-2-display-a-message-in-a-browse-mode-document)"""),
_(u"""        - [Example 3: Announce the automation ID of a UIA object](#user-content-example-3-announce-the-automation-id-of-a-uia-object)"""),
_(u"""        - [Example 4: Send keystrokes](#user-content-example-4-send-keystrokes)"""),
_(u"""        - [Example 5: Stop speech whenever screen content changes if dynamic content change announcement is off](#user-content-example-5-stop-speech-whenever-screen-content-changes-if-dynamic-content-change-announcement-is-off)"""),
_(u"""        - [Example 6: using script decorator](#user-content-example-6-using-script-decorator)"""),
_(u"""- [Add-on module components and development tips](#user-content-add-on-module-components-and-development-tips)"""),
_(u"""    - [The Python Console](#user-content-the-python-console)"""),
_(u"""    - [Working with objects on screen](#user-content-working-with-objects-on-screen)"""),
_(u"""    - [Examining object hierarchy](#user-content-examining-object-hierarchy)"""),
_(u"""    - [Focus vs. navigator object](#user-content-focus-vs-navigator-object)"""),
_(u"""    - [Other useful object-related goodies](#user-content-other-useful-object-related-goodies)"""),
_(u"""    - [Example 1: Finding the value of a slider in a program](#user-content-example-1-finding-the-value-of-a-slider-in-a-program)"""),
_(u"""    - [Specialist objects and overriding object properties at runtime](#user-content-specialist-objects-and-overriding-object-properties-at-runtime)"""),
_(u"""    - [Examples of overlay classes and modified roles](#user-content-examples-of-overlay-classes-and-modified-roles)"""),
_(u"""    - [Input and output: scripts and UI messages](#user-content-input-and-output-scripts-and-ui-messages)"""),
_(u"""    - [Example 2: A basic script dictionary and message output](#user-content-example-2-a-basic-script-dictionary-and-message-output)"""),
_(u"""    - [Example 3: script information using script decorator](#user-content-example-3-script-information-using-script-decorator)"""),
_(u"""        - [Script decorator arguments](#user-content-script-decorator-arguments)"""),
_(u"""    - [Example 4: Scripts for specific objects](#user-content-example-4-scripts-for-specific-objects)"""),
_(u"""    - [Script lookup order and command conflicts](#user-content-script-lookup-order-and-command-conflicts)"""),
_(u"""    - [A few other remarks on scripts](#user-content-a-few-other-remarks-on-scripts)"""),
_(u"""    - [Events](#user-content-events)"""),
_(u"""    - [Example 5: Announcing the changed name of a control](#user-content-example-5-announcing-the-changed-name-of-a-control)"""),
_(u"""    - [List of possible events](#user-content-list-of-possible-events)"""),
_(u"""    - [Events within objects](#user-content-events-within-objects)"""),
_(u"""    - [Other components](#user-content-other-components)"""),
_(u"""    - [Let's build an add-on](#user-content-lets-build-an-add-on)"""),
_(u"""    - [Add-on planning and development tips](#user-content-add-on-planning-and-development-tips)"""),
_(u"""    - [Do's and don'ts](#user-content-dos-and-donts)"""),
_(u"""    - [Frequently Asked Questions about add-on components and development](#user-content-frequently-asked-questions-about-add-on-components-and-development)"""),
_(u"""- [Introduction to global plugins](#user-content-introduction-to-global-plugins)"""),
_(u"""    - [Typical development plan for global plugins](#user-content-typical-development-plan-for-global-plugins)"""),
_(u"""    - [The global plugin code](#user-content-the-global-plugin-code)"""),
_(u"""    - [When to write or not write global plugins](#user-content-when-to-write-or-not-write-global-plugins)"""),
_(u"""    - [A Few more things to remember about global plugins](#user-content-a-few-more-things-to-remember-about-global-plugins)"""),
_(u"""    - [Example 1: Writing computer braille using QWERTY keyboard](#user-content-example-1-writing-computer-braille-using-qwerty-keyboard)"""),
_(u"""    - [Exercises](#user-content-exercises)"""),
_(u"""- [Introduction to app modules](#user-content-introduction-to-app-modules)"""),
_(u"""    - [Differences between app modules and global plugins](#user-content-differences-between-app-modules-and-global-plugins)"""),
_(u"""    - [App module development process and strategies](#user-content-app-module-development-process-and-strategies)"""),
_(u"""    - [Example 2: Simple app module in Notepad](#user-content-example-2-simple-app-module-in-notepad)"""),
_(u"""    - [Example 3: Silencing NVDA in Openbook](#user-content-example-3-silencing-nvda-in-openbook)"""),
_(u"""    - [Example 4: Announcing control property changes while using another app](#user-content-example-4-announcing-control-property-changes-while-using-another-app)"""),
_(u"""    - [Useful app module properties and methods](#user-content-useful-app-module-properties-and-methods)"""),
_(u"""    - [Other remarks on app modules](#user-content-other-remarks-on-app-modules)"""),
_(u"""- [Drivers](#user-content-drivers)"""),
_(u"""    - [Driver components](#user-content-driver-components)"""),
_(u"""    - [A Few important things to remember before, during and after driver development](#user-content-a-few-important-things-to-remember-before-during-and-after-driver-development)"""),
_(u"""    - [Typical driver development steps](#user-content-typical-driver-development-steps)"""),
_(u"""- [Enhancers](#user-content-enhancers)"""),
_(u"""    - [Enhancer components](#user-content-enhancer-components)"""),
_(u"""    - [A Few important things to remember before, during and after enhancer development](#user-content-a-few-important-things-to-remember-before-during-and-after-enhancer-development)"""),
_(u"""    - [Typical enhancer development steps](#user-content-typical-enhancer-development-steps)"""),
_(u"""- [Sharing your add-on and experience with others](#user-content-sharing-your-add-on-and-experience-with-others)"""),
_(u"""    - [The NVDA Add-ons list](#user-content-the-nvda-add-ons-list)"""),
_(u"""    - [The NVDA Community Add-ons web site and code repository](#user-content-the-nvda-community-add-ons-web-site-and-code-repository)"""),
_(u"""- [Advanced Code Examples and Features](#user-content-advanced-code-examples-and-features)"""),
_(u"""    - [Interactive Dialogs](#user-content-interactive-dialogs)"""),
_(u"""        - [Introduction](#user-content-introduction)"""),
_(u"""        - [Example 1: A Basic Dialog](#user-content-example-1-a-basic-dialog)"""),
_(u"""        - [Example 2: A Three-Way Dialog](#user-content-example-2-a-three-way-dialog)"""),
_(u"""    - [Using The Log](#user-content-using-the-log)"""),
_(u"""    - [Threading](#user-content-threading)"""),
_(u"""        - [Introduction](#user-content-introduction)"""),
_(u"""        - [Threading scenarios](#user-content-threading-scenarios)"""),
_(u"""        - [Threading examples](#user-content-threading-examples)"""),
_(u"""    - [Storing and Using Persistent Information Outside Your Add-on](#user-content-storing-and-using-persistent-information-outside-your-add-on)"""),
_(u"""- [Miscellaneous information](#user-content-miscellaneous-information)"""),
_(u"""- [Appendices](#user-content-appendices)"""),
_(u"""    - [Appendix A: add-on terms dictionary](#user-content-appendix-a-add-on-terms-dictionary)"""),
_(u"""    - [Appendix B: Programming and Python concepts every add-on developer needs to know](#user-content-appendix-b-programming-and-python-concepts-every-add-on-developer-needs-to-know)"""),
_(u"""    - [Appendix C: Add-on type comparison](#user-content-appendix-c-add-on-type-comparison)"""),
_(u"""    - [Appendix D: notes and references for scripters of other screen readers](#user-content-appendix-d-notes-and-references-for-scripters-of-other-screen-readers)"""),
_(u"""    - [Appendix E: Python 2 versus 3](#user-content-appendix-e-python-2-versus-3)"""),
"",_(u"""---"""),
"",_(u"""[//]: # (End of TOC)"""),
"",_(u"""## Authors, Contributions, and Copyright"""),
"",_(u"""This guide is primarily maintained, and was originally written, by Joseph Lee ([@josephsl](https://github.com/josephsl)), and is shaped by the NVDA user and developer community. Luke Davis ([@XLTechie](https://github.com/XLTechie)) sometimes serves as editor."""),
"",_(u"""Valuable contributions and corrections from the community are welcome."""),
"",_(u"""If you are contributing via the GitHub Wiki web editing mechanism, please be aware that by default, that mechanism changes the name of this file by replacing all spaces with hyphens (-). **Please correct that before submitting your changes.** The correct name of this file is: **\"NVDA Add-on Development Guide.md\"**."""),
"",_(u"""NVDA is copyright 2006-2020 NV Access Limited. Microsoft Windows, Microsoft Office, Win32 API, and other Microsoft  products are copyright Microsoft Corporation. the IAccessible package is copyright by IBM and the Linux Foundation. Python is copyright by Python Software Foundation. Other products mentioned are copyrighted by their respective copyright holders."""),
"",_(u"""## Introduction"""),
"",_(u"""Welcome to the NVDA Add-on Development Guide. This is the one-stop guide on how to develop NVDA add-ons. This guide also  explains some useful code segments from the NVDA core source code, which highlight concepts for you, as you learn to write add-ons."""),
"",_(u"""For more information on NVDA development, please visit the [NVDA GitHub page]. Be sure to go over the [NVDA Developer Guide] to familiarize yourself with key terms and basics on getting started with add-on development."""),
"",_(u"""## Audience"""),
"",_(u"""This guide is designed for: """),
"",_(u"""* Python beginners"""),
_(u"""* beginners to NVDA development"""),
_(u"""* Expert Python developers"""),
_(u"""* Expert NVDA developers"""),
_(u"""* People familiar with programming languages other than Python."""),
_(u"""* Developers of scripts for other screen readers."""),
"",_(u"""If you are new to NVDA add-on or core development, we recommend that you get to know [Python](https://python.org) first, as it gives the necessary programming background for understanding the rest of the guide. If you are a Python programmer but new to NVDA development, please checkout the [NVDA Developer Guide] and [Design Overview] document."""),
"",_(u"""### Special note on Python version"""),
"",_(u"""Until 2019, NVDA and add-ons were written primarily in Python 2, specifically 2.7. As of July 2019, NVDA was transitioned to use Python 3.7, with some add-on developers modifying their add-on source code to run on Python 2 and 3. With the release of NVDA 2019.3 in February 2020, Python 3 transition is complete. Be sure to keep an eye on NVDA development and add-ons mailing lists, as well as relevant development documentation and notices regarding news on Python 3 and NVDA. For more information on Python 2 versus 3, please read Appendix E."""),
"",_(u"""This guide will use strictly Python 3 code."""),
"",_(u"""### A special note for scripters of other screen readers"""),
"",_(u"""Some of the concepts described in this document are the same across different screen readers, such as objects, windows, events, accessibility API and so on. However, there are important things to be aware of when writing or porting scripts:"""),
"",_(u"""* Unlike some screen readers, NVDA does not have a formal specification or an object model as defined by documentation in other screen readers."""),
_(u"""* The code you write will run inside the same runtime environment as the screen reader itself, thus you can perform things such as obtain focused object directly, modify NVDA's functionality and even replace NVDA functions and classes with your own."""),
_(u"""* Python, and consequently, NVDA is an object-oriented system. In other words, most of your code will consist of defining classes and objects which are then picked up by NVDA at runtime."""),
_(u"""* Unlike scripting engines for some screen readers, there is no special hack involved when you wish to provide a feature that'll work in all applications."""),
_(u"""* Unlike scripting engines for some screen readers, you are not limited to libraries that come with screen readers; as a Python-based program, you can use any python module(s) that fits your needs, including external modules. For example, a popular module used to interface with web applications is JSON (JavaScript Object Notation) module, which isn't bundled with NVDA versions prior to 2017.3. You need to bundle external Python libraries yourself if you choose to use these packages."""),
"",_(u"""### A special note about Windows Store version of NVDA"""),
"",_(u"""As of NVDA 2018.1, foundation has been laid to let NVDA run as a Windows Store application. Once the Windows Store version of NVDA is published to Microsoft Store, users running Windows 10 can go to Store and obtain NVDA. However, there are restrictions that come with this version of NVDA, notably add-ons cannot run in this environment. Thus, if you need to run or write NVDA add-ons, you need to use the classic desktop version of NVDA, available from the [nvaccess.org website](https://www.nvaccess.org/)."""),
"",_(u"""### A very important note about migrating custom extension code to development scratchpad"""),
"",_(u"""If you are coming from NVDA 2018.4 or earlier, you may recall that you are able to run extension modules (sometimes called \"plugins\") inside folders stored in the user configuration directory (e.g. appModules). This functionality has been revised in NVDA 2019.1 as follows:"""),
"",_(u"""1. NVDA will no longer load extension code stored in the following subdirectories of the user configuration folder: appModules, brailleDisplayDrivers, globalPlugins, synthDrivers."""),
_(u"""	* If you find that code inside these folders is no longer working as of NVDA 2019.1, the above reason is why."""),
_(u"""2. You must enable development scratchpad functionality (reserved for developers) if you wish to load custom extension code. To do so:"""),
_(u"""	1. With NVDA 2019.1 (or later) running, go to NVDA menu/Preferences/settings/Advanced."""),
_(u"""	2. You must check \"I understand that changing these settings may cause NVDA to function incorrectly\" checkbox."""),
_(u"""	3. You must check \"Enable loading custom code from Developer Scratchpad directory\" checkbox."""),
_(u"""	4. Select OK."""),
_(u"""3. You must store code that was formerly housed in the above list of subdirectories inside corresponding subdirectories of the scratchpad folder."""),
_(u"""4. If you need to use NVDA 2018.4 and would like to use custom code, you must not remove the above listed subdirectories from the user configuration directory. Otherwise go ahead and remove the folders listed in item 1."""),
"",_(u"""## Add-on Basics"""),
"",_(u"""### What are Add-ons?"""),
"",_(u"""Add-ons are additional small programs that extend NVDA's functionality or support for applications. This may include adding global features, enhancing """),
_(u"""support for an application, adding support for newer braille displays or speech synthesizers, or enhancing visual usage of NVDA via vision enhancers."""),
"",_(u"""A fully constructed add-on will consist of the add-on Python code itself, contained in one or more modules (more on that in the next section), and """),
_(u"""usually some documentation, and other support files. If that sounds daunting: don't worry, we will start small, with examples, and only with Python """),
_(u"""code. The rest of the support structure for an add-on will come later."""),
"",_(u"""Note: add-ons are sometimes called \"Plugins\", especially in the [NVDA Developer Guide]. Although they may appear to be similar, these terms are different:"""),
"",_(u"""* Add-on: one or more modules or components packaged as an archive for easy installation."""),
_(u"""* Plugin: a module or a collection of modules designed to modify NVDA's behavior in various ways."""),
"",_(u"""Throughout this guide, whenever we refer to \"add-ons\", you can assume that they contain at least one plugin or component."""),
"",_(u"""### What Are Add-on Modules?"""),
"",_(u"""Add-ons can act globally (across all of NVDA), in a specific application or program, behind the scenes (at the hardware or software level), or enhance NVDA experience for visual audiences. We call these four """),
_(u"""major areas \"modules\". Every add-on contains at least one module, which is just one or more Python files designed to act in one of those four specific """),
_(u"""areas. Additionally, if it makes sense for the add-on you are developing, your add-on can include more than one module. For example, if your add-on """),
_(u"""provides better accessibility for a specific application, but also provides global commands that work anywhere in NVDA, you would be using two modules."""),
"",_(u"""Currently, NVDA supports these add-on module types:"""),
"",_(u"""* Global plugin: A global plugin adds features for NVDA which can be used anywhere, such as OCR capability."""),
_(u"""* App module: An app module allows enhanced support for a specific program. App modules only run as long as the program runs. They change how NVDA reacts to the windows and controls in the running application. """),
_(u"""* Driver: A driver allows a program to talk to hardware, and in some cases, other software. Currently you can write drivers for new braille displays or speech synthesizers."""),
_(u"""* Enhancer: An enhancer is used to improve NVDA experience for different groups of users as they use computers. Currently one enhancer type, \"vision enhancement provider\", is supported."""),
"",_(u"""### What Are Add-on Packages?"""),
"",_(u"""A package is the single file which contains the code, documentation, and other elements which make up a fully functioning add-on, which is """),
_(u"""intended to be robust enough to be distributed to the public. Each NVDA add-on package is a normal zip file with a file extension of .nvda-addon instead of .zip."""),
"",_(u"""If making an add-on package sounds like a lot of work: don't worry, you don't have to make a package just to start writing and testing your first """),
_(u"""add-on."""),
"",_(u"""### Installing NVDA Add-ons"""),
"",_(u"""You can install NVDA-approved add-on packages via the Add-ons Manager, found on NVDA's tools menu. Alternatively, you can open any .nvda-addon file """),
_(u"""you may have created or downloaded, by selecting it in your Windows file manager, and it should launch the add-on install process."""),
"",_(u"""## Setting Up Your Add-on Development Environment"""),
"",_(u"""Follow these steps to prepare your computer for writing NVDA add-ons."""),
"",_(u"""### Meet System Requirements"""),
"",_(u"""To create an add-on for NVDA, please make sure your system meets the following requirements:"""),
"",_(u"""* NVDA:"""),
_(u"""    - A version of NVDA is available on your computer (either a portable or installed version will work, but we strongly recommend that you install a copy of NVDA on your development computer). Download NVDA from the [NV Access download page](https://www.nvaccess.org/download/)."""),
_(u"""    - Even better: we recommend installing the latest master (alpha) or beta development version to keep up to date with core API changes. You can download the latest snapshots at https://www.nvaccess.org/files/nvda/snapshots/."""),
_(u"""* Python:"""),
_(u"""    - Python 3.7 series, version 3.7.8 32-bit for Windows: https://www.python.org/downloads/release/python-378/"""),
_(u"""    - Although the add-ons community do understand that Python 2 might be required for backward compatibility, we do not recommend using it in production environments."""),
_(u"""* SCons 3, version 3.1.2 or later for generating add-on packages: http://www.scons.org/"""),
_(u"""* Markdown 2.0.1 or later for generating add-on documentation: https://pypi.python.org/pypi/Markdown/2.0.1"""),
_(u"""* The GNU Gettext package for Windows for message localization support. The build can be found at: http://gnuwin32.sourceforge.net/downlinks/gettext.php"""),
_(u"""    - Once downloaded, copy these two exe files to your add-on development folder. See the next section for a description of the add-on folder structure."""),
_(u"""        + msgfmt.exe"""),
_(u"""        + xgettext.exe"""),
_(u"""* If you are developing support for a program, speech synthesizer, or braille display, install the needed software and hardware."""),
_(u"""* Optional Items:"""),
_(u"""    - Git 2.25.0 or later if you wish to upload the add-on to a repository such as [Bitbucket] or [Github] (optional. See below). You can use various Git clients, such as [Git Bash], [Cygwin's Git][Git for Cygwin], and [TortoiseGit]."""),
_(u"""    - The [NVDA Community Add-on Template][add-on template] for ease of add-on file and folder packaging and management (optional)."""),
"",_(u"""Note: if you're using Windows 10 Anniversary Update or later and wish to use Ubuntu on Windows (AKA [Windows Subsystem for Linux][WSL]), Python is already installed. You can then use Advanced Packaging Tool (APT) to obtain SCons and Gettext. You can then use pip to download and install Markdown."""),
"",_(u"""### Add-on Development Folder Structure"""),
"",_(u"""When writing add-ons, it is recommended that you store your add-on code in separate folders, one per add-on. If you chose to download the add-on template, the folder structure will be automatically created."""),
"",_(u"""Once you install the needed dependencies (see above), paste the Gettext package executables into this add-on folder. Skip this if you plan to build your add-on using WSL Bash."""),
"",_(u"""### Add-on folder structure"""),
"",_(u"""Each add-on folder, at a minimum, must contain the following files and folders:"""),
"",_(u"""* manifest.ini to store manifest information such as add-on name, author, and compatibility range (minimum version, last tested version)."""),
_(u"""* An \"addon\" subfolder with the add-on module directory underneath this subfolder (appModules, globalPlugins, synthDrivers, brailleDisplays, visionEnhancementProviders). One or more module folders can be specified."""),
"",_(u"""If you are using the add-on template, the folder structure will automatically be created, so you need to create only the addon subfolder and the add-on module folder(s) and code inside this folder. See the readme file in the template folder for more information on customizing your add-on manifest using the template files."""),
"",_(u"""### Packaging add-ons"""),
"",_(u"""There are two ways of packaging add-ons:"""),
"",_(u"""1. To package your add-on manually, zip up (compress) your add-on folder as a .zip file, then rename the file extension to .nvda-addon."""),
_(u"""2. To use the add-on template with SCons, open Command Prompt with administrator mode (Windows Vista or later) or Bash on Ubuntu on Windows (Windows 10 Anniversary Update with WSL enabled), change to your add-on folder and type `scons`."""),
"",_(u"""For more information on add-on management, see the management chapter in this guide."""),
"",_(u"""## Getting started: Hands-on examples"""),
"",_(u"""So are you ready to start your adventure with add-ons, but not sure as to how to bring it to life? If that is you, please go through this chapter, as it gives you basic information to get you started with add-ons and give you tips on writing code."""),
"",_(u"""Note: for this chapter, we will not use the actual add-on packages. Instead, we'll use scratchpad plugin folders - a number of subdirectories located in a folder called \"scratchpad\", which in turn is a subfolder of your NVDA user configuration folder (available from Start Menu/Screen if NVDA is installed) to store our example Python files."""),
"",_(u"""To edit .py files, you need a word processor which can handle .py files. The best one we recommend is Notepad++."""),
"",_(u"""### How add-on code is organized"""),
"",_(u"""Your add-on code is stored in one or more Python files (.py file). Despite different kinds of add-ons out there, they all have similar layout."""),
"",_(u"""First, you start by writing an optional header for your add-on, such as your name, a brief sentence or two on what the add-on is for and so on. Although this is optional, it is recommended that you write the header as a reminder to keep track of what you are doing with your add-on. If you plan to distribute your add-on, you must write a header with copyright and license notices."""),
"",_(u"""Next, you tell NVDA the modules you need for your add-on file. This is done by writing `import module` where module is the name of the module you wish to use in your code. For example, if you want to hear tones while writing your add-on, write `import tones`. Typically you may need to import two or more modules for your specific add-on (see below on list of modules you need for the type of add-on module you are writing)."""),
"",_(u"""after declaring the modules you need or import, you write your add-on code (defining classes, variables, methods and so on). The most important section is the add-on class code, which will determine the type of add-on module your code will be assigned to."""),
"",_(u"""For instance, if you wish to add support for a program, after importing appModuleHandler and other needed modules, you would write:"""),
"",_(u""" `class appModule(appModuleHandler.AppModule):`"""),
"",_(u"""After that, all you are writing is Python code (see the Python documentation on how to write Python programs)."""),
"",_(u"""### Running your add-on in this example chapter"""),
"",_(u"""Before you can run example add-ons, you must enable development scratchpad from NVDA's advanced settings. After doing so, a new folder named \"scratchpad\" will appear in user configuration folder. See the section on scratchpad above for details on how to do so."""),
"",_(u"""To run your example add-ons from this chapter, open your NVDA user configuration directory (from Start Menu/Screen, look for Explore NVDA user configuration folder\" item). Then look for \"scratchpad\" folder (if enabled), then paste your .py file to the appropriate folder inside this subfolder: appModules folder for app module examples, and globalPlugins folder for global plugins."""),
"",_(u"""### Example 1: Hear a tone when pressing NVDA+A"""),
"",_(u"""Let us start with a simple example: if you press NVDA+A, you will hear a tone for 1 second in any program. Since we want to use this everywhere, it must be a global plugin."""),
"",_(u"""First, if you haven't done so, enable development scratchpad. Then open your user configuration folder, then open the scratchpad folder (if it exists--create it if not), then select globalPlugins folder. Create a new .py file and give it a descriptive name such as example1.py (it is strongly recommended that when you name your global plugin file, give it a short descriptive name). Then open the newly created .py file in the word processor."""),
"",_(u"""The below code implements our example. Put this in your .py file as exactly as shown:"""),
"",_(u"""```python"""),
_(u"""	# Add-on development first example"""),
_(u"""	"""),
_(u"""	import globalPluginHandler"""),
_(u"""	import tones # We want to hear beeps."""),
_(u"""	"""),
_(u"""	class GlobalPlugin(globalPluginHandler.GlobalPlugin):"""),
_(u"""	"""),
_(u"""		def script_doBeep(self, gesture):"""),
_(u"""			tones.beep(440, 1000)  # Beep a standard middle A for 1 second."""),
_(u"""	"""),
_(u"""		__gestures={"""),
_(u"""			\"kb:NVDA+A\": \"doBeep\""""),
_(u"""		}"""),
_(u"""```"""),
"",_(u"""In Python, you make comments by putting hash sign (#) at the start of the comment line."""),
"",_(u"""### Example 1 code explanation"""),
"",_(u"""Our first example lets us sound a beep for one second when we press NVDA+A. But you might be wondering what that above code means, so let's step through the code, one piece at a time."""),
"",_(u"""1. At the top of the file, we wrote a header which tells us that this is an example add-on."""),
_(u"""2. Since this is a global plugin, we need to import a crucial module: global plugin handler, so we wrote `import globalPluginHandler`."""),
_(u"""3. Then we wrote `import tones` to import (load, or include) the tones module, a built-in module from NVDA. Whenever you wish to use a method from a given module, import the needed module(s)."""),
_(u"""4. Next, we defined a class called GlobalPlugin. The text inside the brackets tells us where this class is coming from (more on this concept in a second). A class, in programming, describes an object, such as a person, a desk, a program and others."""),
_(u"""5. Inside the class, we wrote a method (function) called `script_doBeep`. This is an example of a script, a method that'll be run or executed when you press a command. Inside this script, we wrote `tones.beep(440, 1000)` to tell NVDA to sound a middle A tone for 1 second. In programming, a function can take arguments, or a set or parameters which tells the function what to do based on the given values (we'll meet them later). In fact, many methods you'll be writing, including our doBeep script takes one or more arguments. More on scripts later as we journey through the guide."""),
_(u"""6. Lastly, we wrote a simple dictionary (a collection) to store our command (script) bindings for our doBeep script. Here, we told NVDA to assign NVDA+A command for doBeep script. Later you will learn a handy trick that will let you specify script bindings and other information at the same time as the script itself."""),
"",_(u"""Save this file, then restart NVDA. Now whenever you press NVDA+A, you'll hear a middle A tone for 1 second. Once you are comfortable with the add-on code and how it is laid out, you can delete the newly created .py file."""),
"",_(u"""### I don't understand those above terms"""),
"",_(u"""For some, the terms \"class\", \"method\" and so on might be new. Let's go over what these terms are, as they are fundamental for add-on development:"""),
"",_(u"""* Class: a class describes an object. It could describe anything, such as a person, a desk, an NVDA add-on and others. Classes are fundamental to NVDA and other programs - in fact, a number of programmers are skilled at coming up with classes."""),
_(u"""* Method: A method is a short program or a routine that a program runs for doing something, such as generating tones, calculating huge numbers, loading NVDA add-ons and so on. Some people call them \"functions.\""""),
_(u"""* Script: A script is a method which runs when the user performs commands such as pressing certain keys on a keyboard. For example, when you press NVDA+F12, NVDA runs dateTime script, located in one of the NVDA core modules named Global Commands. A script takes two arguments: where the script would be executed (usually \"self\"; more on that later) and the gesture for the script (see below)."""),
_(u"""* Variable: A variable is something that can change, such as name of a person, name of the NVDA add-on we're running, version of NVDA you are using and so on. An add-on file may define one or more variables (for example, to store common constants such as strings)."""),
_(u"""* Module: A module is a collection of methods and variables in a file. When we write add-ons, we are in fact writing additional modules that NVDA can use while it is running."""),
"",_(u"""There are other terms that we'll get to know shortly."""),
"",_(u"""### Example 2: Generate a tone when switching to Notepad"""),
"",_(u"""Most of the below code comes from NVDA Developer Guide."""),
"",_(u"""NVDA doesn't just let you add global commands, but it also allows writing code to enhance usage of programs through app modules. An app module is also a Python file except that, this time, the name of the .py file is the name of the executable for a program. For example, an app module for Notepad would be named notepad.py."""),
"",_(u"""The below code, from NVDA developer Guide, gives a short example of a typical app module: play a short beep when switching to Notepad. Put the below code in notepad.py, which in turn should be placed in appModules folder under scratchpad directory (if enabled) in your user configuration folder in order for it to run."""),
"",_(u"""```python"""),
_(u"""	# An example app module."""),
_(u"""	"""),
_(u"""	import appModuleHandler"""),
_(u"""	import tones"""),
_(u"""	"""),
_(u"""	class AppModule(appModuleHandler.AppModule):"""),
_(u"""		"""),
_(u"""		def event_gainFocus(self, obj, nextHandler):"""),
_(u"""			tones.beep(256, 200)"""),
_(u"""			nextHandler()"""),
_(u"""```"""),
"",_(u"""### Example 2 code explanation"""),
"",_(u"""We're seeing more new code here. Let's go over this, again piece by piece:"""),
"",_(u"""1. Unlike the first example, the crucial module we need is appModuleHandler."""),
_(u"""2. The class that we are using is AppModule."""),
_(u"""3. Unlike last time, we're using events, a method run when certain events occur such as when names of controls change. Events take an object as one of its arguments, the object for which the event needs to be dealt with, or, as many people say, \"fired.\""""),
_(u"""4. Inside the event method, we're also seeing a call to `nextHandler`. This method is used in event methods to tell NVDA to pass the event so it can be taken care of, such as saying the name of a control after beeping."""),
"",_(u"""### More new terms please"""),
"",_(u"""Other terms you may see include:"""),
"",_(u"""* Event: An event is a method that'll be run when something occurs, such as when a program is focused, when names of controls change and so on."""),
_(u"""* Call: We say a function or method \"calls\" another method when we run the second method from the first method. Our first example above demonstrates this, by calling the tones.beep method from our script method."""),
_(u"""* Object: An object is an instance of a class - that is, a class coming to life when a program runs. Throughout your add-ons, as you write classes and when you run your add-ons, your classes come to life as objects, commonly abbreviated to obj. In NVDA, an object may refer to controls or parts of a program."""),
_(u"""* Self: In Python, the word \"self\" means current class (if we're defining one, such as when writing add-ons), or means the class for which a method is defined. For example, in a class called numbers, the add method would have self as the first argument, reminding us that add method is part of the class of numbers. In NVDA development world, self usually means the current NVDA object (see below), or in the add-on development, the instance of an add-on. Many of your methods will have self as the first argument."""),
"",_(u"""Just like example 1, once you're comfortable with app module code, you may wish to delete the Notepad app module code unless you want to keep hearing beeps when you switch to Notepad. The actual differences between global plugins and app modules will become more clear when we talk about them in more detail throughout this guide."""),
"",_(u"""### A few tips for beginners"""),
"",_(u"""Here are a few useful tips passed on by add-on writers:"""),
"",_(u"""* Start with easy add-ons, such as saying a message, tones and so on."""),
_(u"""* Write and test one method at a time."""),
_(u"""* If you are writing app modules or drivers, become familiar with programs, synthesizers or braille displays you wish to support (e.g. read documentation, try using them, etc.)."""),
_(u"""* When defining commands (especially in global plugins), consult commands used in NVDA and other add-ons first before assigning a new command in your add-on to avoid command conflicts."""),
"",_(u"""## Useful modules from NVDA core"""),
"",_(u"""Throughout the life of add-on development, you'll come across some useful modules from NVDA core that would be helpful in your add-on code. This section explains them and some functions in those modules that would be useful, along with examples that utilize some of them."""),
"",_(u"""Note: for readers who are scripters for other screen readers, see Appendix D on equivalent functions between screen reader scripting facilities."""),
"",_(u"""### List of useful NVDA core modules and methods"""),
"",_(u"""The following lists available NVDA core modules and some useful methods and classes found in those modules:"""),
"",_(u"""* Addon Handler (addonHandler.py): The module which implements the add-on subsystem. The addonHandler.initTranslation() method is used to initialize internationalization support for your add-on."""),
_(u"""* NVDA basic API (api.py): A collection of core methods used throughout NVDA, such as obtaining focus and navigator object, setting focus and so on. Some of the most useful functions are:"""),
_(u"""    - `api.getFocusObject()`: Retrieves the focused control (returns the object with focus)."""),
_(u"""    - `api.getNavigatorObject()`: Fetches the current navigator object. If NVDA is set to follow system focus, the focus and navigator object will be the same, otherwise a different object is returned."""),
_(u"""    - `api.getForegroundObject()`: Returns the foreground window of the current application (the parent of this object is the application itself)."""),
_(u"""    - These have a corresponding method to set a certain object as the focus or navigator object. Note that this lets NVDA see the new focus or navigator object but does not actually change system focus."""),
_(u"""    - `api.getDesktopObject()`: returns the shell (topmost level) object."""),
_(u"""    - `api.copyToClip()`: copies text to the clipboard."""),
_(u"""* App Module subsystem (appModuleHandler.py, appModules): The subsystem in charge of handling app modules (see the chapter on app modules for more information)."""),
_(u"""* ARIA support (aria.py): Implements support for Accessible Rich Internet Applications (ARIA)."""),
_(u"""* Base object collection (baseObject.py): Contains useful base objects such as scriptable objects (see the chapter on NVDA objects and overlay objects for more information)."""),
_(u"""* Braille input and output subsystem (braille.py, brailleInput.py): Controls braille output to and input from braille displays, needed by braille display driver add-ons."""),
_(u"""* Built-in modules (builtin.py): Allows access to builtin modules when working with add-ons."""),
_(u"""* Configuration (config): Manages configuration and profiles (profiles are available in 2013.3 or later)."""),
_(u"""* Content recognition engines (contentRecog packages): adds ability to use OCR and other methods to recognize content in various scenarios. NVDA ships with Windows 10 OCR engine."""),
_(u"""* Controls and states collection (controlTypes.py): Includes dictionaries on control types (roles) and possible states that a control can be in."""),
_(u"""* Events (eventHandler.py): Handles various events such as gaining focus. One function in particular is useful in app modules:"""),
_(u"""    - `eventHandler.requestEvents(process ID, window class name for the control, event to be requested)`: Allows NVDA to listen to specific events for certain controls while using another app."""),
_(u"""* Extension points (extensionPoints.py): provides a way to let add-ons and other modules define and respond to specific action such as profile switches, actions in an add-on and so on. The following extension points are defined:"""),
_(u"""    - `extensionPoints.Action`: notifies when something happens e.g. profile switches."""),
_(u"""    - `extensionPoints.Decider`: decides whether to process something further e.g. processing keyboard input from a remote system."""),
_(u"""    - `extensionPoints.Filter`: modifies a given text for further processing e.g. advanced speech sequences."""),
_(u"""* Global Commands collection (globalCommands.py): A list of global commands available while using NVDA (see section on script scope for more information)."""),
_(u"""* Global Plugin subsystem (globalPluginHandler.py): The module needed for controlling global plugins."""),
_(u"""* NVDA GUI (gui): A collection of classes used by NVDA to display its messages graphically. Includes GUI's for NVDA menu, add-on manager and others."""),
_(u"""* Hardware port utilities and input/output management (hwPortUtils.py, hwIo.py): A set of utilities for communicating over serial and other hardware ports, useful during driver add-on development."""),
_(u"""* IAccessible support (IAccessibleHandler, IAccessible objects): Used for supporting Microsoft Active Accessibility (MSAA)/IAccessible controls."""),
_(u"""* Input management (inputCore.py): Manages input from the user."""),
_(u"""* Java Access Bridge support (JABHandler.py): A collection of methods used for supporting JAB subsystem used for Java applications."""),
_(u"""* Keyboard input (keyboardHandler.py): Supports entering commands from the keyboard."""),
_(u"""* Logging facility (logHandler.py): Allows a module to write logs to be viewed by a developer or a user via Log Viewer. It includes the following class:"""),
_(u"""    - `logHandler.Log`: The class which implements logging facility."""),
_(u"""* Math content presentation (MathPress packages): allows NVDA to recognize and interact with various math content and markup. NVDA ships with MathML support package and support for Math Player is included in 2015.2 or later."""),
_(u"""* Mouse support (mouseHandler.py): Supports mouse commands."""),
_(u"""* NVDA objects collection (NVDAObjects): A collection of NVDA objects or controls used in many applications and standards such as UIA (User Interface Automation). Some objects require special actions to be performed, and these are specified in behaviors module in NVDA objects package. Some of the common ones include:"""),
_(u"""    - `NVDAObjects.NVDAObject`: the base class for NVDA objects that define events, properties and so on."""),
_(u"""    - `NVDAObjects.behaviors`: a collection of behaviors for specific controls, such as edit fields with or without selection detection, terminals, tool tips, help balloons, a way to simulate table commands in various controls and others."""),
_(u"""    - `NVDAObjects.IAccessible`: a collection of MSAA/IAccessible objects, such as working with SysListView32 list views and others."""),
_(u"""    - `NVDAObjects.JAB`: a collection of classes used when interfacing with Java applications and Java Access Bridge."""),
_(u"""    - `NVDAObjects.UIA`: various classes for objects powered by UI Automation. Since 2016, it is also the home of a collection of controls used in legacy (not Chromium) Microsoft Edge and objects powered by EdgeHTML rendering engine."""),
_(u"""    - `NVDAObjects.Window`: generic windows and other custom objects such as those found in Microsoft Excel."""),
_(u"""* Review facility (review.py): assists with working with review cursor."""),
_(u"""* Scripts support (scriptHandler.py): Handles scripts, methods executed due to the user pressing keyboard commands and other input."""),
_(u"""    - scriptHandler.script: a decorator that allows information about the bound script to be defined while defining the script itself, including description (input help message), gesture/gestures (commands, the latter used for a list of gestures), and script category."""),
_(u"""* Speech output (speech): Controls speech output."""),
_(u"""* Synthesizer driver support (synthDriverHandler.py): This is the core module needed for speech synthesizer add-ons."""),
_(u"""* Widget text access (textInfos): Allows access to text for widget and documents."""),
_(u"""* Touchscreen support (touchHandler.py): Provides support for touchscreen input (installed versions only)."""),
_(u"""    - `touchHandler.touchSupported()` (NVDA 2018.1 and later): returns if the system supports touch interaction."""),
_(u"""* Tone output (tones.py): Allows the user to hear tones. The following function is defined:"""),
_(u"""    - `tones.beep(pitch in hertz, duration in milliseconds, left channel volume, right channel volume)`: Plays a tone of specified pitch for specified duration. The first two arguments are mandatory, while the other two are optional."""),
_(u"""* User interface messages (ui.py): Includes various functions for speech and/or braille output, including:"""),
_(u"""    - `ui.message(message to be spoken/brailled, speech priority)`: Speaks or brailles the message (a string surrounded by quotes). Optionally, speech priority can be specified to interrupt what the speech synthesizer is saying when announcing the message."""),
_(u"""    - `ui.browseableMessage(message to be shown, title, HTML or not)`: displays some text and an optional title in a web browser window. If you want to use HTML markup, set isHTML argument to True."""),
_(u"""* UIA support (UIAHandler.py, UIA objects): Used for supporting UIA (User Interface Automation) controls (Windows 7 and later)."""),
_(u"""* Virtual buffers (virtualBuffers): Handles virtual buffer documents such as web sites."""),
_(u"""* Windows API wrappers: the following modules are thin wrappers around Windows API libraries. You can use the below modules or call Windows API directly via ctypes.windll.dllname (e.g. ctypes.windll.user32):"""),
_(u"""    - `winKernel`: Wraps some constants, structures and functions from kernel32.dll that are commonly encountered in NVDA."""),
_(u"""    - `winUser`: wraps around constants, structures and functions defined in user32.dll that are used by NVDA."""),
"",_(u"""The modules without .py extension are directories, containing specialist modules. There are other useful methods out there in addition to the list above, but the above are the most useful ones. See the NVDA source code documentation for other methods, or see the examples below on how these methods and others are used throughout the life of an add-on."""),
"",_(u"""### Some real-life examples"""),
"",_(u"""Let's go through some simplified real-life examples demonstrating how the components listed above are used in common add-on writing scenarios."""),
"",_(u"""#### Example 1: am I on the right app where the focus is located?"""),
"",_(u"""The below code checks whether the navigator object is located somewhere on the same app or not."""),
"",_(u"""```python"""),
_(u"""	import api"""),
_(u"""	import ui"""),
_(u"""	"""),
_(u"""	def sameApp(obj=None):"""),
_(u"""		if obj is None:"""),
_(u"""			obj = api.getNavigatorObject()"""),
_(u"""		return api.getFocusObject().appModule == obj.appModule"""),
_(u"""```"""),
"",_(u"""The `api.getNavigatorObject()` function returns the current navigator object, the object you are interested in as opposed to focused object. Each NVDA object includes `appModule` member which records on which app an object is located."""),
"",_(u"""#### Example 2: Display a message in a browse mode document"""),
"",_(u"""In NVDA 2015.2 and later, it became possible to display a message in a browse mode window so people can use browse mode commands to review the message content. The below code displays \"Hello world\" in a document window."""),
"",_(u"""```python"""),
_(u"""	import ui"""),
_(u"""	"""),
_(u"""	ui.browseableMessage(\"Hello World!\", isHtml=False)"""),
_(u"""```"""),
"",_(u"""The isHtml flag tells NVDA whether to treat the message as HTML text."""),
"",_(u"""#### Example 3: Announce the automation ID of a UIA object"""),
"",_(u"""In UI Automation, automation ID is used to identify different screen elements. The following code displays this information in a browsable window."""),
"",_(u"""```python"""),
_(u"""	import ui"""),
_(u"""	from NVDAObjects.UIA import UIA"""),
_(u"""	"""),
_(u"""	def announceUIAId():"""),
_(u"""		obj = api.getFocusObject()"""),
_(u"""		if isinstance(obj, UIA):"""),
_(u"""			ui.browseableMessage(obj.UIAAutomationId, isHtml=True)"""),
_(u"""```"""),
"",_(u"""#### Example 4: Send keystrokes"""),
"",_(u"""You can ask NVDA to send specific keystrokes by instantiating a keyboard gesture object."""),
"",_(u"""```python"""),
_(u"""	import keyboardHandler"""),
_(u"""	"""),
_(u"""	def sendApplicationsKey():"""),
_(u"""		keyboardHandler.KeyboardInputGesture.fromName(\"applications\").send()"""),
_(u"""```"""),
"",_(u"""#### Example 5: Stop speech whenever screen content changes if dynamic content change announcement is off"""),
"",_(u"""The below code is a handler for a name change event that stops speech whenever screen content changes if dynamic content change announcement is off."""),
"",_(u"""```python"""),
_(u"""	import appModuleHandler"""),
_(u"""	import config"""),
_(u"""	import speech"""),
_(u"""	"""),
_(u"""	class AppModule(appModuleHandler.AppModule):"""),
_(u"""	"""),
_(u"""		def event_nameChange(self, obj, nextHandler):"""),
_(u"""			if not config.conf[\"presentation\"][\"reportDynamicContentChanges\"]:"""),
_(u"""				speech.cancelSpeech()"""),
_(u"""```"""),
"",_(u"""#### Example 6: using script decorator"""),
"",_(u"""A decorator is a function that wraps and returns another function while performing internal operations. For example, a decorator can make changes to the internals of a function or check something on behalf of another function without the wrapped function being aware of what's happening."""),
"",_(u"""In NVDA 2018.3, a special decorator named scriptHandler.script was introduced to make it easier to define information about a script. A script's description (input help mode message), gesture or gestures (commands bound to this script), and script category can be assigned as you define the script."""),
"",_(u"""Recall the first example where a beep was heard when NVDA+A was pressed. The drawback is that the actual script and the command (gesture) associated with it were defined in different places. You can group them by using script decorator (scriptHandler.script) as shown below."""),
"",_(u"""```python"""),
_(u"""	# Add-on development first example global plugin, now edited to use script decorator"""),
_(u"""	"""),
_(u"""	import globalPluginHandler"""),
_(u"""	import scriptHandler"""),
_(u"""	import tones"""),
_(u"""	"""),
_(u"""	class GlobalPlugin(globalPluginHandler.GlobalPlugin):"""),
_(u"""	"""),
_(u"""		@scriptHandler.script(gesture=\"kb:NVDA+A\")"""),
_(u"""		def script_doBeep(self, gesture):"""),
_(u"""			tones.beep(440, 1000)  # Beep a standard middle A for 1 second."""),
_(u"""```"""),
"",_(u"""Throughout this guide, whenever script examples are shown, script decorator will be used unless noted otherwise."""),
"",_(u"""This is just a sample of things you can encounter as you write add-ons and how you can use various NVDA components to achieve what you want. We'll tour add-on components and meet more functions throughout this guide."""),
"",_(u"""## Add-on module components and development tips"""),
"",_(u"""An add-on module consists of a number of components. This includes handling input and output, working with different NVDA objects, reacting to events, storing configuration and more."""),
"",_(u"""This chapter introduces key components and concepts that are used in add-on development, such as NVDA objects, scripts, event handling and additional topics with examples."""),
"",_(u"""Note that the [NVDA core development guide][NVDA Developer Guide] introduces the below concepts. This chapter is intended as an extension of that document. Consult the NVDA developer guide for a brief introduction."""),
"",_(u"""Note for scripters of other screen readers: you might be familiar with some of the concepts introduced in this section. Please read this section if you want a better understanding of how some of them are used in NVDA."""),
"",_(u"""### The Python Console"""),
"",_(u"""This guide sometimes suggests that you use the [Python Console]. The console is a feature of NVDA which can be very useful to developers. It is described in more detail in chapter 5 of the [NVDA Developer Guide]."""),
_(u"""You can activate it by going to the NVDA Tools menu, or by pressing NVDA+control+z."""),
"",_(u"""### Working with objects on screen"""),
"",_(u"""An object is an instance of a class - that is, a class coming to life while a program is running. For example, if a class called button has been defined, the button on a screen is the object of this button class."""),
"",_(u"""In NVDA, an object is a representation of a control or part of a program. This includes buttons, check boxes, edit fields, toolbars, sliders and even the application window. These are organized into hierarchies, or parent-child relationships where an object may contain child objects - for example, a list object in Windows Explorer may contain one or more list items, and the parent of this list might be the Windows Explorer window. The object that you're examining right now is termed \"navigator object.\""""),
"",_(u"""The NVDA object (or simply called object) contains a number of useful properties or attributes. These include the object's name, its value (checked, text of the edit window, etc.), role (check box, window, embedded object, etc., location (screen coordinates) and more. NVDA objects also contain useful methods for manipulating them, such as changing the value of the object, reacting to events for the object (gains focus, value has changed, etc.) and so on."""),
"",_(u"""In many situations, an NVDA object may belong to a class of related objects. For each object class, NVDA provides ways of handling it. These classes include IAccessible, JAB, UIA and so forth. These classes and behaviors for each class of objects is defined in NVDAObjects directory in the NVDA source code, and to use them in your add-on, import the appropriate object class handler for the object you're using (e.g. if you're working with an IAccessible object, import NVDAObjects.IAccessible.)."""),
"",_(u"""Two of these object classes merit special mention: virtual buffers and tree interceptors. A tree interceptor allows NVDA to work with a \"tree\" of objects as though they are just one object. A special case of tree interceptor is virtual buffer, which allows NVDA to work with complex documents such as PDF documents. These objects contain a special mechanism to determine whether a given keyboard command will be passed to the application or handled by NVDA (for instance, browse mode where first letter navigation is used to move between elements)."""),
"",_(u"""### Examining object hierarchy"""),
"",_(u"""There are a number of ways which you can use to see the hierarchy of an object for a given program:"""),
"",_(u"""1. Using object navigation commands (NVDA+Numpad 2/4/5/6/8) with simple review mode turned off."""),
_(u"""2. Using [Python Console], use obj.next/previous/parent/firstChild/lastChild attributes. If you want to see all available properties, from Python Console, type dir(obj)."""),
"",_(u"""If you wish to see a more detailed description about the navigator object, while the navigator object is located at the object you're interested in, press NVDA+F1 to launch log viewer and examine the developer info shown. The root of all objects in Windows is the desktop, or shell object."""),
"",_(u"""### Focus vs. navigator object"""),
"",_(u"""In your add-on, you might wish to work with various objects and manipulate them. These may include changing the focused object, synchronizing navigator and focus objects, changing the role of an object and so on."""),
"",_(u"""A focus object is the currently focused control. These are linked to keyboard focus - that is, it follows the highlighted control. In contrast, a navigator object is the object you're interested in. Since navigator objects can move anywhere, you can examine two objects at once: the focused object and the navigator object. For instance, you might be focused on an edit field while examining the title bar as the navigator object. We already saw an example above where we can check if we're on two different apps by checking for app modules for focus versus navigator object."""),
"",_(u"""In your add-on, to fetch the object with focus, write `someObj = api.getFocusObject()`. The someObj can be named differently - the convention is to use the name \"obj\". To fetch the navigator object (which might be different from the focused object), use `obj = api.getNavigatorObject()`."""),
"",_(u"""### Other useful object-related goodies"""),
"",_(u"""Here are some other methods which work with NVDA objects, all located in api.py module:"""),
"",_(u"""* If you wish to obtain the foreground object (useful if you wish to look at some child object of the foreground window), use `obj = api.getForegroundObject()`. The name of the foreground object, usually the top-level window of an application is treated as a title by NVDA and can be obtained by pressing NVDA+T."""),
_(u"""* From [Python Console], to see the number of child objects that an object contains (for instance, the children, or widgets of a foreground window), type `obj.childCount`. The value 0 means that there are no more child objects."""),
_(u"""* To set some object as the new focus or navigator object, use `api.setFocusObject(obj)` or `api.setNavigatorObject(obj)`. These do not change what Windows views as focused object, as these change what NVDA thinks is the focus and navigator object."""),
_(u"""* You can fetch various properties of an object by specifying obj.property where property is the attribute you wish to see (e.g. obj.value). Common properties include name, value, states, role, app module, window class name and so on."""),
"",_(u"""### Example 1: Finding the value of a slider in a program"""),
"",_(u"""Suppose you are asked by a user to give him the value of a slider in a program using an app module. After looking at the object hierarchy and other properties, you know that the toolbar is the last child of the foreground object."""),
"",_(u"""Here is the code to implement this feature:"""),
"",_(u"""```python"""),
_(u"""	# Object example 1"""),
_(u"""	"""),
_(u"""	import api"""),
_(u"""	import appModuleHandler"""),
_(u"""	"""),
_(u"""	class AppModule(appModuleHandler.AppModule):"""),
_(u"""	"""),
_(u"""		sliderChildIndex = -1 # The variable to store the child index."""),
_(u"""		"""),
_(u"""		def getSliderValue(self):"""),
_(u"""			fg = api.getForegroundObject()"""),
_(u"""			sliderVal = fg.children[self.sliderChildIndex].value"""),
_(u"""			return sliderVal"""),
_(u"""```"""),
"",_(u"""In this code, the method `fg.children[index]` is used to retrieve the child with the given index (here, since we said the toolbar is the last child, the index would be minus 1, or the very last child; we could have used fg.lastChild). Alternatively, you can use `fg.getChild(-1) in certain situations (IAccessible, for example).)"""),
"",_(u"""However, this code has an issue: what if the slider value is actually within the first child of the actual slider control? One way to fix this is to check the object's role. The modified code looks like this:"""),
"",_(u"""```python"""),
_(u"""	def getSliderValue(self):"""),
_(u"""		from controlTypes import ROLE_SLIDER # It is possible to import from within a method."""),
_(u"""		fg = api.getForegroundObject()"""),
_(u"""		slider = fg.lastChild"""),
_(u"""		if slider.role == ROLE_SLIDER: return slider.firstChild.value"""),
_(u"""```"""),
"",_(u"""Thus, when we know for sure that we're dealing with the slider, the method returns the value of the slider's first child (if that is the case). Note the two equals signs for equality, as opposed to just one equals sign for assignment."""),
"",_(u"""There are other examples you can try to familiarize yourself with object navigation and manipulation:"""),
"",_(u"""* Obtaining the name of an object that is located somewhere else in the program."""),
_(u"""* Moving the navigator to the foreground object."""),
_(u"""* Setting focus to another program."""),
_(u"""* Locating the first status bar in a program with multiple status bars."""),
"",_(u"""For real-life examples on objects in NVDA, consult the NVDA source code or source codes of various community add-ons."""),
"",_(u"""### Specialist objects and overriding object properties at runtime"""),
"",_(u"""Sometimes, it is not enough to work with default behavior for a control. For example, some parts of a program may need custom gestures, or one may need to change the role of a window to that of a button."""),
"",_(u"""NVDA provides two methods for creating or manipulating specialist, or overlay objects (or classes), each suited for different needs:"""),
"",_(u"""* `event_NVDAObject_init(self, object we're dealing with)`: If you wish to override certain attributes of a control such as its role or label (name), you can use this method to ask NVDA to take your \"input\" into account when meeting objects for the first time (or initialized). For instance, if the control has the window class name of TForm (seen on many Delphi applications), you can ask NVDA to treat this control as a standard window by assigning obj.role = ROLE_WINDOW (see control types dictionary for list of available roles)."""),
_(u"""* `chooseNVDAObjectOverlayClasses(self, object, list of classes)`: This allows NVDA to use your own logic when dealing with certain objects. For example, this is useful if you wish to assign custom gestures for certain parts of a program in your app module (in fact, many app modules define objects to deal with certain parts of a program, then uses chooseNVDAObjectOverlayClasses to select the correct object when certain conditions are met). These custom objects must be based on a solid object that we wish to deal with (mostly IAccessible is enough, thus most overlay objects inherit from, or is the child or specialist class of IAccessible objects). In certain situations, you can use this method to drop a property from an object, such as telling NVDA to not treat this object as a progress bar by removing progress bar behavior from this object."""),
"",_(u"""Note that in case of the second method, the class(s) with the given name must be present in the file, which is/are inherited from a known base object (in Python, the syntax for the inheritance is `childClass(baseClass)`, and is usually read as, \"this child class inherits from this base class\". We'll see code like this later)."""),
"",_(u"""### Examples of overlay classes and modified roles"""),
"",_(u"""Below examples illustrate the uses of the two overlay and attribute modification methods we've discussed above:"""),
"",_(u"""An example of the first case: modifying an attribute."""),
"",_(u"""```python"""),
_(u"""	# Reassign some Delphi forms as window."""),
_(u"""	from controlTypes import ROLE_WINDOW"""),
_(u"""	"""),
_(u"""	def event_NVDAObject_init(self, obj):"""),
_(u"""		if obj.windowClassName == \"TForm\": obj.role = ROLE_WINDOW"""),
_(u"""```"""),
"",_(u"""This means that whenever we encounter a window with the class name of \"TForm\", NVDA will treat this as a normal window."""),
"",_(u"""Example 2 deals with an app module which has two objects for dealing with specific parts of a program, then uses chooseNVDAObjectOverlayClasses to assign the logic for each control."""),
"",_(u"""```python"""),
_(u"""	#An example of overlay classes"""),
_(u"""	"""),
_(u"""	class enhancedEdit(IAccessible):"""),
_(u"""		# Some code to be run when window class name is MyEdit."""),
_(u"""	"""),
_(u"""	class MainWindow(IAccessible):"""),
_(u"""		# Another code, this time adding custom gestures for main window of the program."""),
_(u"""	"""),
_(u"""	# In the app module:"""),
_(u"""	"""),
_(u"""	def chooseNVDAObjectOverlayClasses(self, obj, clsList):"""),
_(u"""		if obj.windowClassName == \"myEdit\": clsList.insert(0, enhancedEdit)"""),
_(u"""		elif obj.windowClassName == \"TWindow\": clsList.insert(0, mainWindow)"""),
_(u"""```"""),
"",_(u"""In both cases, the object that we wish to check must be inserted as the first element of the clsList. The effect is that these custom objects will take precedence when looking up gestures or code (behavior) for the object, and in the developer info, these custom objects will come first when MRO (Method Resolution Order) for the navigator object is displayed."""),
"",_(u"""Note: You may need to tune these two methods to provide correct overlay classes for very specific controls (such as checking names, specific roles, etc.), otherwise you may find that two or more identical-looking controls are assigned to your custom object when in fact they are very different. Also, the event_NVDAObject_init is only available in app modules."""),
"",_(u"""### Input and output: scripts and UI messages"""),
"",_(u"""Another crucial component of add-ons is handling commands from users and displaying what the add-on is doing. These are done via scripts (input) and UI messages (output)."""),
"",_(u"""A script is a method run when the user performs certain commands. For example, when you press NVDA+T, NVDA runs a script in global commands module called SayTitle. In Poedit, for instance, when a translator presses Control+Shift+A, NVDA will read translator comments added by the programmer to help clarify a given translatable string. This command is not a native NVDA command, but it is defined in the Poedit app module to perform this function."""),
"",_(u"""Typically, an add-on which accepts scripts will have a list of command:function mapped somewhere in the module. The simplest is a gestures (commands) dictionary, a python dictionary (typically named __gestures) which holds commands as keys and scripts as values for these keys (more than one key, or command can be bound to scripts). Alternatively, information about each script such as its description and bound gestures can be specified through script decorator. These dictionaries are loaded when add-on loads and is cleared when either NVDA exits or the app for the app module loses focus (that is, the user has switched to another program)."""),
"",_(u"""Another way to bind scripts is via runtime insertion. This is done by creating another gestures dictionary apart from __gestures dictionary which holds context-sensitive gestures such as manipulating a single control. Then the developer would use inputCore.bindGesture (or inputCore.bindGestures if more than one gestures/scripts are defined) to define certain gestures for a time, then using inputCore.clearGestures then inputCore.bindGestures(__gestures) to remove the added gestures. A more elegant way, which involves scripts for specific objects, will be covered when we talk about app modules and assigning gestures to specific parts of a program."""),
"",_(u"""For most scripts, you don't have to worry about sending the command to the application. However, in case the script performs additional tasks while sending the key to the active application, you can use `gesture.send()` to send the command first before performing additional work."""),
"",_(u"""In a similar manner to scripts, the UI module allows you to say or braille what your add-on is doing. This is done by using `ui.message(something to say)` where `something to say` is replaced by a string for NVDA to say. Alternatively, you can call speech and braille handler methods directly if you want speech to say one thing and the braille display to show something else. We'll not go over `ui.message` here (you'll see examples of those), but what's more important is scripts, so we'll focus on that in this section."""),
"",_(u"""As of time of writing, NVDA supports input from the keyboard, braille displays with or without braille keyboard and touchscreens. These input types have a corresponding gesture prefix (kb for keyboard, br for braille and ts for touchscreen) which identifies the type of gesture. Output can be sent via speech and/or braille."""),
"",_(u"""### Example 2: A basic script dictionary and message output"""),
"",_(u"""In this example, we'll define two scripts called \"sayHello\" and say\"GoodBye\", then bind them into two separate gestures."""),
"",_(u"""```python"""),
_(u"""	# An example fragment for script assignment from a global plugin."""),
_(u"""	import ui"""),
_(u"""	"""),
_(u"""	def script_sayHello(self, gesture):"""),
_(u"""		ui.message(\"Hello!\")"""),
_(u"""	"""),
_(u"""	def script_sayGoodBye(self, gesture):"""),
_(u"""		ui.message(\"Good Bye!\")"""),
_(u"""	"""),
_(u"""	__gestures={"""),
_(u"""		\"kb:control+NVDA+1\":\"sayHello\","""),
_(u"""		\"kb:Control+NVDA+2\":\"sayGoodBye\""""),
_(u"""	}"""),
_(u"""```"""),
"",_(u"""Now when you press Control+NVDA+1, NVDA will say, \"Hello\", and when you press Control+NVDA+2, NVDA will say, \"Good bye.\" This is the basic code on receiving commands and sending messages."""),
"",_(u"""### Example 3: script information using script decorator"""),
"",_(u"""As we have seen with an example above, script decorator can be used to assign gestures to scripts easily. But script decorator can do more than assign gestures: it can be used to provide additional information such as input help message for a script."""),
"",_(u"""In addition to the modified example 2, the below example will add an input help message for both scripts, along with setting Control+NVDA+3 to make NVDA say \"good bye\"."""),
"",_(u"""```python"""),
_(u"""	# An example fragment for script decorator usage from a global plugin."""),
_(u"""	import ui"""),
_(u"""	from scriptHandler import script"""),
_(u"""	"""),
_(u"""	@script("""),
_(u"""		description=\"Says Hello\","""),
_(u"""		gesture=\"kb:control+NVDA+1\""""),
_(u"""	)"""),
_(u"""	def script_sayHello(self, gesture):"""),
_(u"""		ui.message(\"Hello!\")"""),
_(u"""	"""),
_(u"""	@script("""),
_(u"""		description=\"Says good bye\","""),
_(u"""		gestures=[\"kb:Control+NVDA+2\", \"kb:Control+NVDA+3\"]"""),
_(u"""	)"""),
_(u"""	def script_sayGoodBye(self, gesture):"""),
_(u"""		ui.message(\"Good Bye!\")"""),
_(u"""```"""),
"",_(u"""#### Script decorator arguments"""),
"",_(u"""You can pass in the following information about a script to script decorator:"""),
"",_(u"""* description: short description about a script. This will be presented in input help mode and in input gestures dialog."""),
_(u"""* category: the category associated with this script, used to group the script under an appropriate category in input gestures dialog."""),
_(u"""* gesture: a single gesture bound to the script."""),
_(u"""* gestures: a list of gestures bound to this script."""),
"",_(u"""### Example 4: Scripts for specific objects"""),
"",_(u"""As in specialist objects above, scripts can be assigned to certain objects by specifying gestures dictionary for this particular object. Here is an example from an app module which defines scripts for main window of a media player program, defined using script decorator:"""),
"",_(u"""```python"""),
_(u"""	# Scripts for objects for a program."""),
_(u"""	from NVDAObjects.IAccessible import IAccessible"""),
_(u"""	from scriptHandler import script"""),
_(u"""	"""),
_(u"""	class Player(IAccessible)"""),
_(u"""	"""),
_(u"""		@script(gesture=\"kb:NVDA+T\")"""),
_(u"""		def script_saySongName(self, gesture):"""),
_(u"""			ui.message(self.songTitle_) #Suppose if that variable has been defined."""),
_(u"""	"""),
_(u"""	# And in the main app module:"""),
_(u"""	def chooseNVDAObjectOverlayClasses(self, obj, clsList):"""),
_(u"""		if obj.windowClassName == \"PlayerWindow\": clsList.insert(0, Player)"""),
_(u"""```"""),
"",_(u"""There is something odd going on with this example: normally, when you press NVDA+T, NVDA says the title of the current window, but in this example, it announces the name of the song instead. This is the result of script lookup (see below) where the script for the current object is run instead of title script from global commands. This is a common way of binding new scripts at runtime."""),
"",_(u"""### Script lookup order and command conflicts"""),
"",_(u"""As you write add-ons with scripts, you need to remember the following script lookup order when trying to assign commands to scripts:"""),
"",_(u"""1. Global plugins."""),
_(u"""2. App modules for the currently focused program."""),
_(u"""3. NVDA objects we're dealing with."""),
_(u"""4. Global commands."""),
"",_(u"""For example, if you assign the command NVDA+Shift+Y to an app module script, NVDA will run that script from that program since no global plugin is using this command. However, if a global plugin which uses that command is installed, the script from the global plugin will be run instead of the app module script. Similarly, from the above example, when using programs other than that media player, NVDA will run a command from the global commands collection when NVDA+T is pressed; but as long as we're using this media player, NVDA+T will announce the name of the song (NVDA objects in app modules takes precedence)."""),
"",_(u"""Because of the above rule, one should be careful when defining a script for an add-on. To help you with this, keep the following guidelines handy:"""),
"",_(u"""1. First, consult the NVDA commands quick reference to see if the command you wish to use has been defined in global commands. You should try to minimize conflicts with built-in NVDA commands. An exception is commands for app modules where same command may be used differently from one program to another."""),
_(u"""2. Read the documentation for add-ons (especially global plugins) to see if any add-on is using this command, and if so, contact the add-on author to come up with an alternate binding."""),
"",_(u"""### A few other remarks on scripts"""),
"",_(u"""* You can use any modifiers as parts of commands for scripts (for example, Alt+NVDA+letter). However, in order to avoid command conflicts, try minimizing use of commands that programs might use such as Control+letter, Alt+Shift+letter and so on."""),
_(u"""* When assigning keyboard commands, keyboard key labels are case insensitive."""),
_(u"""* You can define a script category to show the user where your add-on script will be used (shown in Input Gestures dialog in NVDA 2013.3 or later). There are two ways of doing this: module level via `scriptCategory` attribute from the add-on module, or designating the category for each script via either `script_name.category` attribute or as part of script decorator by defining the category argument. It is recommended that you name your script category the same as the add-on name."""),
_(u"""* You can define the input help mode message for a script by either using `__doc__` attribute (commonly known as docstrings) or by passing in a short description to description argument of script decorator. Script description is also used in Input Gestures dialog to show the description for a script."""),
_(u"""* If you need to leave one or more scripts unassigned (for example, if a gesture conflicts with a global command), do not include the gesture binding for the script in the gestures dictionary or do not define gesture/gestures argument in script decorator. This helps minimize gesture conflicts and allows users to assign custom gestures for scripts."""),
_(u"""* If there are two objects, A and B and if B inherits from A and both contain same command for a script, you can assign \"None\" to script name in object B (subclass) to bypass a command when dealing with commands from object B. For example, if F10 is defined for both objects and F10 is not used in object B, you can assign object B's F10 command to \"None\" so F10 can be sent to the operating system. This is implemented in some NVDA core modules and in StationPlaylist Studio add-on."""),
"",_(u"""### Events"""),
"",_(u"""You can ask NVDA to do something if something happens. For example, you can ask NVDA to say the new name for an object when it's name changes, or say the new item's value when the item gets focused. These conditions, or actions are called events."""),
"",_(u"""When an event occurs, NVDA does the following:"""),
"",_(u"""1. Finds out what the event was (for example, a check box gains focus)."""),
_(u"""2. Performs actions for the event (e.g. says the name and the checked state of this check box)."""),
_(u"""3. Passes the event down the chain in case other objects may have actions associated with the event."""),
"",_(u"""Depending on where the event is defined, you'll need two or four things when defining an event. If it is declared from the add-on module, the required parts are event name, the add-on module (self), object and next handler in case the object has other events associated with it. If it is defined as part of an object, the name of the event and the object (self) is required."""),
"",_(u"""A typical event routine looks like this:"""),
"",_(u"""```python"""),
_(u"""	def event_eventName(self, obj, nextHandler):"""),
_(u"""		# Do some action."""),
_(u"""		nextHandler()"""),
_(u"""```"""),
"",_(u"""For object events, use:"""),
"",_(u"""```python"""),
_(u"""	def event_eventName(self):"""),
_(u"""		# Event routine."""),
_(u"""```"""),
"",_(u"""In fact, we have met an actual \"event\" before: `event_NVDAObject_init`. This is a special event (one of many events defined in NVDA) fired when NVDA meets a new object and initializes it according to your input (see the section on overriding object properties for more information). Let's meet other events you may see while writing your add-on."""),
"",_(u"""### Example 5: Announcing the changed name of a control"""),
"",_(u"""The below code came from one of the add-on app modules."""),
"",_(u"""Below is a routine for an event which tells you the name of some text on the screen when the text changes."""),
"",_(u"""```python"""),
_(u"""	def event_nameChange(self, obj, nextHandler):"""),
_(u"""		if obj.windowClassName == \"TStaticText\": ui.message(obj.name)"""),
_(u"""		nextHandler()"""),
_(u"""```"""),
"",_(u"""As you can see, whenever the text object's name changes, NVDA will announce the new name to the user. The \"name change\" event is one of the many events that you can define custom actions for in your add-on (the complete list is below)."""),
"",_(u"""Note: You can define events for any object of your choice, especially controls in a program (where you can define custom actions for events in your app module). If this is the case, you need to make sure that the control meets certain conditions you set, such as name, role and so forth to let NVDA keep an \"eye\" on that specific object."""),
"",_(u"""### List of possible events"""),
"",_(u"""This is a list of common events you may define custom actions for in your add-on:"""),
"",_(u"""* gainFocus: The user has moved the focus to a specific control, or the user has just switched to a program."""),
_(u"""* loseFocus: Opposite of gainFocus."""),
_(u"""* nameChange: The name of a control has changed (see above for an example)."""),
_(u"""* valueChange: The value of the control such as text of a field has changed."""),
_(u"""* stateChange: Useful to keep track of whether check boxes, buttons and other control's state (checked, selected, etc.) has changed."""),
_(u"""* foreground: the object we're interested in has become the foreground window of the program."""),
"",_(u"""Less common events that are used in specific situations include:"""),
"",_(u"""* typedCharacter: the user has entered something on a keyboard."""),
_(u"""* appModule_gainFocus: user has switched to the app where an app module is defined. Common uses include adding touchscreen commands for specific apps, announcing extra info about the current state of the app and so on."""),
_(u"""* appModule_loseFocus: opposite of appModule_gainFocus."""),
_(u"""* descriptionChange: the description for a control provided by the accessibility API has changed."""),
_(u"""* suggestionsOpened: used in controls where one can type something and suggestions will be shown based on entered text. The default implementation in NVDA plays a sound to indicate appearance of suggestions."""),
_(u"""* suggestionsClosed: opposite of suggestionsOpened. The suggestions events requires NVDA 2017.3 and the object must inherit from `NVDAObjects.behaviors.EditableTextWithSuggestions` class."""),
"",_(u"""### Events within objects"""),
"",_(u"""The above section described event routines from an add-on's perspective. This is just one way of defining events. The other way is to define events from within objects, and is same as above except that it only takes one argument (self)."""),
"",_(u"""### Other components"""),
"",_(u"""Besides objects, scripts and events, you can add other components in your add-on for working with specific controls. For example, you can use a textInfo module (such as NVDAObjects.NVDAObjectTextInfo) for working with text and text offsets in edit fields and other controls, or use external modules from third-party developers for specialized tasks such as windows registry access (_winreg) and others. You can also use Python's built-in modules (such as time, functools, etc.) for advanced operations."""),
"",_(u"""One notable component is text infos, a way to let add-ons gain access to text located on objects. You can access text, move around in it (such as via lines and words), and manipulate portions via marking ranges and offsets. For most add-ons, it isn't required to define custom text infos, as the underlying accessibility API will provide suitable information."""),
"",_(u"""Another useful component is mathematical text presentation library (mathPres). This is used to allow NVDA to access math content in places such as web browsers, as well as for add-ons to define custom math presentation layers and ways to access math content in various applications. So far, math content retrieval is done on text marked with MathML with MathPlayer installed."""),
"",_(u"""If you wish to store settings for your add-on, use ConfigObj or NVDA's built-in configuration manager to store configuration files and settings. ConfigObj defines settings as a collection of dictionaries that can be updated in real time. You can also pass in validation map to allow NVDA's configuration manager (config.conf)to validate settings for your add-on and let add-on settings become profile-specific settings."""),
"",_(u"""Finally, you can ask NVDA to perform some routines while the add-on is loading or being terminated. This is done by defining `__init__` and `terminate` method for the add-on. Depending on the plugin type, use:"""),
"",_(u"""* For global plugin:"""),
_(u"""  ```"""),
_(u"""  def __init__(self):"""),
_(u"""  	super(GlobalPlugin, self).__init__()"""),
_(u"""  	# The routine to do when the global plugin loads."""),
_(u"""  	# Warning! You should always call super method first in order to initialize various foundations correctly."""),
_(u"""  ```"""),
_(u"""* For app modules:"""),
_(u"""  ```"""),
_(u"""  def __init__(self, *args, **kwargs):"""),
_(u"""  	super(AppModule, self).__init__(*args, **kwargs)"""),
_(u"""  	# What NVDA should do when the app module loads."""),
_(u"""  ```"""),
_(u"""* For terminating, regardless of the add-on type:"""),
_(u"""  ```"""),
_(u"""  def terminate(self):"""),
_(u"""  	# Do something when the add-on terminates."""),
_(u"""  	# Warning! Never initialize ANY core module such as GUI in terminate method as doing so will prevent NVDA from exiting properly."""),
_(u"""  ```"""),
"",_(u"""### Let's build an add-on"""),
"",_(u"""Now that we have a basic overview of components of add-ons, we're ready to build some simple add-ons. But first, let's go over the actual add-on development process, debugging tips, do's and don'ts and other tips."""),
"",_(u"""### Add-on planning and development tips"""),
"",_(u"""Over the years, the NVDA community built a number of powerful add-ons for NVDA users. Over the course of these years, the add-on writers gathered some useful tips when it comes to writing your own add-ons. Here are a number of them:"""),
"",_(u"""* Get to know NVDA: it is important that you become familiar with NVDA commands, concepts and tips. Subscribe to NVDA users groups to learn more about NVDA and how NVDA works, as you'll be extending it via your add-ons."""),
_(u"""* Get to know the product at hand: as noted earlier, it is important that you get to know the software you're writing the app module for, synthesizers and braille displays you'll be writing the driver for and so on."""),
_(u"""* Plan ahead: if you know you'll be maintaining your add-on for a number of months or years, it is useful to have a plan and write the add-on code to prepare for future extensions. For example, working on features that you need to implement now, dividing parts of a program to objects and so on."""),
_(u"""* Ready to debug and test your add-on: writing your add-on code is just one part of the overall add-on development. The other part is testing and debugging your add-on to make sure that users use your add-on with minimal errors. As you write your add-ons, be sure to test your code regularly."""),
_(u"""* Most importantly, have fun."""),
"",_(u"""### Do's and don'ts"""),
"",_(u"""Here are a few things you should do and not do throughout add-on development:"""),
"",_(u"""1. Do talk with users: it is important to remember that your add-ons will be used by NVDA users around the world, so it is important to keep in touch with your users to gather bug reports and suggestions."""),
_(u"""2. Do ask for help if needed: If you're stuck, you can ask other add-on writers anytime for solutions or tips, or if you need to, ask for collaboration from other add-on developers."""),
_(u"""3. Do test your add-on on more than one computer: sometimes, a bug in one computer may help you solve problems on your add-on on your computer later."""),
_(u"""4. Don't use fancy code without understanding your intentions: a typo or forgotten indentation can become troublesome when you debug an add-on."""),
_(u"""5. Do keep up to date with NVDA core changes: sometimes, you may find that your add-on might not work due to NVDA core code changes. Be sure to read \"changes for developers\" section in NVDA's What's New document to keep up to date with code changes that may affect your add-on."""),
"",_(u"""### Frequently Asked Questions about add-on components and development"""),
"",_(u"""Q. When I try to obtain an object using an index, it fetches an object one after the index I wrote.  """),
"",_(u"""This is the side effect of zero-based indexing (count starts at 0)."""),
"",_(u"""Q. When importing a module, NVDA says it cannot locate the module.  """),
"",_(u"""Did you type the correct name of the module? Did you extract the module files in the correct location? Try fixing the typo, look at the import path and try importing again."""),
"",_(u"""Q. What is the difference between simple review and normal review and which one should I use?  """),
"",_(u"""Simple review excludes layout objects such as windows, grouping and so on which are placed for layout purposes. Normal review includes these as well. The choice of using simple review versus normal review depends on your situation."""),
"",_(u"""Q. The command for my app module does not work in my app module; instead, NVDA does something else.  """),
"",_(u"""Check if a global plugin which uses the command is installed. First, disable the global plugin and try again."""),
"",_(u"""Q. How can I use Win32 API in my add-on or object?"""),
"",_(u"""There is a document written by an add-on developer which talks about using Win32 API in your add-on. Select [this link][Using Win32 API] to view this document."""),
"",_(u"""Q. How can I create dialogs in my add-on?"""),
"",_(u"""See the [Interactive Dialogs](#user-content-interactive-dialogs) section."""),
"",_(u"""Q. Can I create functions and assign variables outside the module classes?"""),
"",_(u"""Yes. This is useful if you need to reference them from inside the add-on class. For example, you may have a function that's defined outside your class that you'll need to use from more than one method in a global plugin class."""),
"",_(u"""Q. I want to save user settings for my add-on. Can this be done?"""),
"",_(u"""Yes. You'll need to use a library that allows persistence, such as ConfigObj library (configObj), JSON, or pickle to manage configuration. Some add-ons (such as OCR) which uses configuration files store their configuration as an ini file in NVDA's user configuration folder. For global plugins, you can load and save user configuration from the add-on when the add-on is created (__init__) or finished (terminate), respectively. You cannot do this easily with app modules. Also, you'll need to provide a facility (commands, dialogs, etc.) where users can configure add-on settings."""),
"",_(u"""Q. I have a script which calls a function that runs for a long time, and I cannot run NVDA commands when my script runs."""),
"",_(u"""One way to fix this is using threads (separate, independent  operations in a program) via Python's threading module. In order to do this, create a method which you know will run for a long time, then from the script which calls this method, create a new thread (see Python's threading module documentation) that'll be in charge of running this method. This way other NVDA commands can be performed while the add-on method does its work (see Google Speech Recognition module for an example code)."""),
"",_(u"""Q. I would like to port a module written in Python 2 syntax for use as an NVDA add-on."""),
"",_(u"""This cannot be done easily. One handy module for this purpose is six, which allows running Python 2 and 3 code. NVDA 2019.3 and later is strictly a Python 3 release."""),
"",_(u"""Q. My add-on uses GUI facility, and after installing NVDA 2018.3, I get errors related to wxPython."""),
"",_(u"""NVDA 2018.3 uses wxPython 4, whereas earlier versions use older wxPython releases. If you want to support older NVDA releases, you need to use conditional statements (if/else) and version checks so the appropriate code path can be used."""),
"",_(u"""Q. After installing NVDA 2019.1, users say my add-ons are not compatible."""),
"",_(u"""NVDA 2019.1 introduces add-on compatibility flags (sometimes called compatibility range) that tells NVDA the following information:"""),
"",_(u"""* Minimum NVDA version (minimumNVDAVersion): an add-on can specify minimum NVDA version required for the add-on. This is useful if you need to use features introduced or changed in a given NVDA release without supporting older NVDA releases."""),
_(u"""* Last tested NVDA version (lastTestedNVDAVersion): tells NVDA the highest tested release for the add-on. Without this flag being set, NVDA will treat your add-ons as incompatible with the latest release."""),
"",_(u"""Words in parentheses are manifest keys. Starting in NVDA 2019.1, these compatibility flags are mandatory for all add-ons."""),
"",_(u"""Q. My app module that was stored under appModules folder in user configuration folder isn't working in NVDA 2019.1."""),
"",_(u"""This is because NVDA 2019.1 will not load custom extension code stored in subfolders of user configuration folder anymore. See the section on scratchpad for details."""),
"",_(u"""Q. Should I convert gestures dictionary and script docstring attribute to script decorator?"""),
"",_(u"""It is up to you whether or not you wish to use older gestures dictionary and script docstring or the newer script decorator to define script information. For new add-ons, script decorator is preferred for easily defining script information on the spot."""),
"",_(u"""Q. What is the recommended coding style for add-ons?"""),
"",_(u"""The following is baseline coding style for add-ons, deriving from NVDA screen reader coding style:"""),
"",_(u"""* Use tab for indentation."""),
_(u"""* Use camel case for function and variable names e.g. someFunction."""),
"",_(u"""Q. I noticed that NVDA does not come with all Python libraries."""),
"",_(u"""Most notably, NVDA does not ship with asyncio. You must include additional libraries inside your add-on component folder."""),
"",_(u"""We did not include programming or Python-related FAQ's, as there are sites which answer questions about Python such as coding style. Consult these documents if you have issues with Python code."""),
"",_(u"""Now that we have covered basic add-on components, let's learn about how to package what you know in your add-on modules themselves: global plugins, app modules, drivers, and enhancers."""),
"",_(u"""## Introduction to global plugins"""),
"",_(u"""A global plugin adds features available everywhere. For example, if there is a control that will be used in many applications, then you can write a global plugin to handle them throughout NVDA. Another example is adding additional features to NVDA that can be used in all programs, such as OCR capability, place marker management and so on."""),
"",_(u"""A global plugin is a Python source code (.py) file with the name of your plugin. For example, if you're adding support for rich edit fields in many applications, you can name your plugin as richEditSupport.py. When naming them, try be brief so you can see what your plugin does."""),
"",_(u"""IMPORTANT: although enhancers may appear to be identical with global plugins (and several enhancers were created as global plugins in the past), they are not the same. See Enhancers section for details."""),
"",_(u"""### Typical development plan for global plugins"""),
"",_(u"""Typically, a global plugin is developed thus:"""),
"",_(u"""1. You or someone suggests a feature or support for a particular control across different programs."""),
_(u"""2. You plan your global plugin (see the section on when to write or not write global plugins)."""),
_(u"""3. You write your global plugin and test it. Once it is done and tested, you release the plugin."""),
"",_(u"""Since global plugins are Python files, you can use the full power of python in your add-on code. Also, since global plugins have access to full power of NVDA code such as events, scripts and objects, you can use the concepts you learned from previous sections."""),
"",_(u"""### The global plugin code"""),
"",_(u"""As shown earlier, the procedure for writing global plugins is same as writing any Python program, except that you import globalPluginHandler and put your add-on code in a class called `GlobalPlugin` which inherits from `globalPluginHandler.GlobalPlugin` (see the example in the first intro chapter). If you need to use third-party modules, you need to place the package in the same folder as the global plugin file and import the external module(s). Then define objects (usually overlay objects), methods and so on in your code."""),
"",_(u"""### When to write or not write global plugins"""),
"",_(u"""Since global plugins are used everywhere, you might be tempted to write support for a single application using global plugin alone. However, this is not the case. There are other guidelines to keep in mind when deciding whether to write a global plugin or not:"""),
"",_(u"""You might consider writing a global plugin if:"""),
"",_(u"""1. You or a user wishes to use a certain feature everywhere."""),
_(u"""2. You need to support same controls across different applications, provided that the control behaves the same in these programs."""),
"",_(u"""You should not write a global plugin if:"""),
"",_(u"""1. If you wish to enhance support for a single application."""),
_(u"""2. You are writing support for speech synthesizers or braille displays."""),
"",_(u"""### A Few more things to remember about global plugins"""),
"",_(u"""* When you write scripts in your global plugin, the commands you assign to them will take precedence (they are looked up first). Therefore it is important to consult the NVDA user guide and help for other add-ons to minimize command conflicts."""),
_(u"""* Each global plugin must be placed in globalPlugins directory in your add-on folder structure."""),
_(u"""* It is possible to use more than one Python file in your global plugin. If this is the case, you need to put them in a folder (name must be the name of the plugin) inside globalPlugins folder, with the main plugin file named __init__.py."""),
_(u"""* If you need to do something when the global plugin is loaded (such as loading the user configuration), you need to write an __init__ method in your plugin class. In this method, you need to call the __init__ method in the super (globalPluginHandler.GlobalPlugin) first before doing other startup work. Also, if you need to do something when the global plugin ends, define terminate method."""),
"",_(u"""Let's go through some examples and exercises."""),
"",_(u"""### Example 1: Writing computer braille using QWERTY keyboard"""),
"",_(u"""You are meeting with a client who uses Duxbury braille translator (a popular braille document production program). This client is working with another user of NVDA who wishes to write computer braille from his computer keyboard everywhere. Based on this, you decide to write a global plugin, and found a module that allows the computer keyboard to act like a braille keyboard using a function."""),
"",_(u"""The global plugin, named brailleWrite.py, would look like this:"""),
"",_(u"""```python"""),
_(u"""	# An example global plugin."""),
_(u"""	"""),
_(u"""	import qtbrl # The braille entry module."""),
_(u"""	import globalPluginHandler"""),
_(u"""	from scriptHandler import script"""),
_(u"""	"""),
_(u"""	class GlobalPlugin(globalPluginHandler.GlobalPlugin):"""),
_(u"""		brlentry = False # Braille entry is not active."""),
_(u"""		"""),
_(u"""		@script("""),
_(u"""			description=\"Toggles braille entry on or off.\","""),
_(u"""			gesture=\"kb:NVDA+X\""""),
_(u"""		)"""),
_(u"""		def script_toggleBrailleEntry(self, gesture):"""),
_(u"""			self.brlentry = True if not self.brlentry else False # Toggle braille entry mode."""),
_(u"""```"""),
"",_(u"""With this background in mind, try some of the short exercises below."""),
"",_(u"""### Exercises"""),
"",_(u"""1. Write a global plugin named nvdaVersion.py to say the current NVDA version when NVDA+Shift+V is pressed."""),
_(u"""2. A user wants to hear the time announced every minute. Using the clock on the system tray, write a global plugin to announce when the time changes (hint: you need to use an event and check the role of the clock object)."""),
"",_(u"""## Introduction to app modules"""),
"",_(u"""An app module enhances support for a particular program. For example, you can write an app module which adds convenience commands for reading various parts of the screen, or you can define how a particular control should behave in a program."""),
"",_(u"""An app module is a Python (.py) file with the name corresponding to the executable name of a program. For example, an app module for Winamp is named winamp.py since Winamp's executable name is winamp.exe."""),
"",_(u"""NVDA itself comes with several app modules, such as Winamp, Adobe Reader, Microsoft Office programs and so on."""),
"",_(u"""### Differences between app modules and global plugins"""),
"",_(u"""At first glance, app modules may look the same as any global plugin. However, app modules have additional properties that global plugins lack, including:"""),
"",_(u"""* Instead of `globalPluginHandler`, you need to import `appModuleHandler`. The class to implement is `AppModule(appModuleHandler.AppModule)`."""),
_(u"""* App modules are stored in appModules folder in your add-on directory structure and is named the same as the executable name of the program."""),
_(u"""* You can ask NVDA to enter sleep mode in a program where NVDA will not speak or braille anything while using the program, and any keyboard commands you press will be handled by the program directly. This is done by setting `sleepMode` attribute in the AppModule class to True."""),
_(u"""* Some apps present information in the form of a webpage, and if this happens, browse mode can be used. However, in NVDA 2019.2 and later, this ability is disabled for apps such as Skype. To restore browse mode functionality, you need to set disableBrowseModeByDefault to False."""),
_(u"""* The `event_NVDAObject_init` routine is only available in app modules."""),
_(u"""* You can ask NVDA to keep an eye on an object to handle events for them even if the user is using another app."""),
"",_(u"""### App module development process and strategies"""),
"",_(u"""A typical app module is developed thus:"""),
"",_(u"""1. You or a user requests enhanced support for a program."""),
_(u"""2. If possible, contact the app vendor (programmer) to ask accessibility improvements for the program from their end."""),
_(u"""3. With or without cooperation from app vendor, you would examine how the program works and areas on the screen that needs to be read out."""),
_(u"""4. Write and test the app module (with users) until the app module is ready for release."""),
"",_(u"""As you write app modules, try these tips:"""),
"",_(u"""1. Use objects to represent parts of a program. This is done in two steps: define the control for parts of a program via objects (inheriting from some object such as IAccessible), then use `chooseNVDAObjectOverlayClasses` routine to tell NVDA to work with your custom object when working with that control. See overlay classes section for tips."""),
_(u"""2. If possible, test your app module using two or more versions of the program to make sure your app module works with those versions."""),
_(u"""3. You should not incorporate all desired features in version 1.0 - leave some of them for a future release."""),
"",_(u"""### Example 2: Simple app module in Notepad"""),
"",_(u"""Suppose you wish to find out which line you're editing in Notepad. Assuming that Notepad will show status bar at all times, you wish to assign a key combination to read the current line number."""),
"",_(u"""The app module for Notepad would look like this:"""),
"",_(u"""```python"""),
_(u"""	# Example app module for Notepad, notepad.py."""),
_(u"""	import appModuleHandler"""),
_(u"""	import api"""),
_(u"""	import ui"""),
_(u"""	from scriptHandler import script"""),
_(u"""	"""),
_(u"""	class AppModule(appModuleHandler.AppModule):"""),
_(u"""	"""),
_(u"""		@script(gesture=\"kb:NVDA+S\")"""),
_(u"""		def script_sayLineNumber(self, gesture):"""),
_(u"""			# Suppose line number is in the form \"  ln 1\"."""),
_(u"""			lineNumList = api.getStatusBar().name.split()"""),
_(u"""			lineNum = lineNumLisst[2]+linenumList[3]"""),
_(u"""			ui.message(lineNum)"""),
_(u"""```"""),
"",_(u"""So whenever you run Notepad, when you press NVDA+S, NVDA will say line number."""),
"",_(u"""### Example 3: Silencing NVDA in Openbook"""),
"",_(u"""Openbook is a scanning and reading program from Freedom scientific. Since Openbook provides speech, you can tell NVDA to enter sleep mode while Openbook (openbook.exe) is running using the below app module:"""),
"",_(u"""```python"""),
_(u"""	# Silencing NVDA in openbook, openbook.py."""),
_(u"""	import appModuleHandler"""),
_(u"""	"""),
_(u"""	class AppModule(appModuleHandler.AppModule):"""),
_(u"""	"""),
_(u"""		sleepMode = True"""),
_(u"""```"""),
"",_(u"""With that single line of code, NVDA will enter sleep mode in that program (you should do this only if the program provides speech and/or braille support on its own)."""),
"",_(u"""### Example 4: Announcing control property changes while using another app"""),
"",_(u"""You can ask NVDA to handle specific events while focused on another app. This is done by calling eventHandler.requestEvents in app module's __init__ method. In order to invoke this, you need process ID (PID) for the application, window class name for the object and the name of the event to be handled."""),
"",_(u"""The below code allows NVDA to announce value changes while focused on another application."""),
"",_(u"""```python"""),
_(u"""	# Example app module for a messenger app."""),
_(u"""	# The object we wish to track has window class name of \"MessengerWindow\"."""),
_(u"""	"""),
_(u"""	import appModuleHandler"""),
_(u"""	import eventHandler"""),
_(u"""	"""),
_(u"""	class AppModule(appModuleHandler.AppModule):"""),
_(u"""	"""),
_(u"""		def __init__(self, *args, **kwargs):"""),
_(u"""			super(AppModule, self).__init__(*args, **kwards)"""),
_(u"""			eventHandler.requestEvents(self.processID, \"MessengerWindow\", \"valueChange\")"""),
_(u"""```"""),
"",_(u"""Once defined, even if focused in another app, new messages (values) will be announced."""),
"",_(u"""### Useful app module properties and methods"""),
"",_(u"""`sleepMode` and `processID` are just two of many attributes that app modules have. Other useful properties and methods used in app modules include the following:"""),
"",_(u"""* appName: the name of the app (usually the name of the executable)."""),
_(u"""* productName: Records the actual product name for the app."""),
_(u"""* productVersion: Records the version of the app."""),
_(u"""* is64BitProcess: if true, the app is a 64-bit process (only true if you're using a 64-bit app under 64-bit Windows versions)."""),
_(u"""* dumpOnCrash: if you are debugging apps that crashes often, you can call this function to let NVDA save a crash dump of this app in the temp files directory so you can retrieve it later."""),
_(u"""* disableBrowseModeByDefault: some apps are essentially web documents, and as such, browse mode will be invoked. You must set this value to True if you want to force NVDA to treat this application as a proper aplication i.e. disable browse mode."""),
_(u"""* appPath: records the path to the app executable."""),
_(u"""* appArchitecture: the intended processor architecture for the app e.g. x86, AMD64, ARM64."""),
_(u"""* isWindowsStoreApp: applicable on Windows 8, 8.1, and 10, determines if the app is hosted inside an app container such as a Store app."""),
"",_(u"""And other properties. Type dir(obj.appModule) from [Python Console] for the complete list."""),
"",_(u"""### Other remarks on app modules"""),
"",_(u"""Here are other remarks regarding app modules:"""),
"",_(u"""* If you find that different versions of the program are laid out differently e.g. locations for controls are different, then you can write code which can handle these cases. There are a number of options you can choose from: adding some constants in your app module to handle different object locations, writing code for these controls (one per version) in custom objects which will be chosen in overlay class method and so on."""),
_(u"""* If possible, try working with services that the app provides, such as COM (Component Object Model) methods (for example, Outlook app module), API's the app provides (such as Winamp) and so on."""),
_(u"""* To support an application that works the same as another program (especially if you're writing an app module for a 64-bit version of a 32-bit program for which you also wrote an app module), use the following code fragment (called aliasing):\\"""),
_(u"""  `from appName import *`\\"""),
_(u"""  where appName is the name of the app module and * (asterisk or star) means import everything. For an example of this, look at NVDA's app modules for Miranda32 and Miranda64."""),
_(u"""* If you wish to extend an app module that comes with NVDA, use the following code fragment (this is called overriding the built-in module):\\"""),
_(u"""  `from nvdaBuiltin.appModules.appName import *`\\"""),
_(u"""  Where appName is the app module you wish to extend. For example, if you wish to support different controls in Windows calculator (calc.py), use:\\"""),
_(u"""  `from nvdaBuiltin.appModules.calc import *`\\"""),
_(u"""* Many app modules (both built-in and third-party ones) use app names as part of the name for a constant (a value that doesn't change). For example, in NVDA's Powerpoint module (powerpnt.py), many constants start with \"PP\". Similarly, in Station Playlist Studio app module, many constants in the app module file (splstudio.py) starts with \"SPL\". This is used to remind you where these constants are used."""),
"",_(u"""## Drivers"""),
"",_(u"""A driver allows software such as NVDA to communicate with hardware or use functionality provided by another software. Typically, when people speak of drivers, they usually refer to a program installed on a computer that allows software to communicate with a specific piece of hardware, such as video cards, keyboards and so on."""),
"",_(u"""In NVDA, drivers refer to modules that NVDA can use to communicate with a speech synthesizer or a braille display. For instance, you can write a braille display driver that sends braille output to your braille display, or ask your synthesizer to switch languages and provide configurable settings."""),
"",_(u"""### Driver components"""),
"",_(u"""All drivers (regardless of target device or software to be supported) import appropriate modules such as `synthDriverHandler`. For most drivers, majority of the driver code deals with communicating with the target device or software, and all drivers must define the driver class (synthDriverHandler.SynthDriver or braille.BrailleDisplayDriver)."""),
"",_(u"""All driver classes, at a minimum, must contain:"""),
"",_(u"""* Driver identifier: a camel-case string such as \"oneCore\" that uniquely identifies a given driver."""),
_(u"""* Friendly name: the name that'll appear under synthesizer or braille settings dialogs."""),
_(u"""* Availability flag: a class method named `check` that tells NVDA that the driver is ready for use."""),
_(u"""* Connection manager: a set of routines that instructs NVDA as to how to locate a given synthesizer or a braille display."""),
_(u"""* Output handler: a function that'll perform the actual output processing. For synthesizers, `speak` method must be present; for braille displays, `display` method is needed."""),
"",_(u"""For speech synthesizers, they need to have:"""),
"",_(u"""* Synth settings ring options: a list of synthesizer settings users can adjust via synth settings ring."""),
"",_(u"""For braille displays:"""),
"",_(u"""* Input handlers: if input from the braille display is desirable, the driver author must implement responders for commands such as braille keys, routing buttons and additional hardware."""),
_(u"""* Command set: a map that identifies NVDA command assignments for various display hardware buttons."""),
"",_(u"""### A Few important things to remember before, during and after driver development"""),
"",_(u"""* Before writing a driver, make sure you have the needed software and/or hardware."""),
_(u"""* Be sure to study protocols and APIs used by a speech synthesizer or a braille display (this is more so for braille displays which may implement different protocols)."""),
_(u"""* Make sure you know how to communicate with your equipment or software - ports, USB IDs, Bluetooth addresses, serial port settings, DLLs and so on."""),
_(u"""* Work with another person who happens to use the equipment or software you are writing driver(s) for."""),
"",_(u"""### Typical driver development steps"""),
"",_(u"""When writing drivers, you may wish to follow the recommended steps for app module development (planning, talking to vendors, user test, etc.). However, since drivers require intimate knowledge of hardware and/or software, you should spend more time on testing your driver. This is more so if you are writing a driver for a braille display which can send arbitrary commands (braille commands, routing buttons, etc.)."""),
"",_(u"""## Enhancers"""),
"",_(u"""An enhancer is a module that helps certain groups of users use computers more efficiently. Enhancers may include cursor tracking, magnification, and other enhancements."""),
"",_(u"""Currently NVDA can provide assistance through vision enhancement providers. A vision enhancement provider is an enhancer that allows people with low vision or sight use computers effectively by working in tandem with NVDA. Enhancements may include cursor highlighting, screen curtain effect, and magnifying parts of the screen. These enhancers are stored under \"visionEnhancementProviders\" folder and defined as a \"VisionEnhancementProvider\" class which inherits from \"vision.providerBase.VisionEnhancementProvider\"."""),
"",_(u"""Note: because only one enhancer is supported at this time, we will refer to vision enhancement provider in the sections below."""),
"",_(u"""### Enhancer components"""),
"",_(u"""An enhancer such as vision enhancement provider will look similar to a combination of a global plugin and a driver (see above sections for explanations). For the most part, components used for drivers are applicable. These include:"""),
"",_(u"""* Enhancer identifier: a camel-case string such as \"screenCurtain\" that uniquely identifies this enhancer."""),
_(u"""* Friendly name: the name that'll appear under Vision dialog."""),
_(u"""* Supported enhancements: a frozen set of enhancement roles this provider will introduce.."""),
_(u"""* Startup check: a routine that will ensure NVDA is running on a specific environment where the enhancer would be most helpful, such as checking for a specific Windows release."""),
_(u"""* Startup and shutdown: a class constructor that instructs the enhancer to come online and a \"terminate\" method that shuts it down."""),
_(u"""* Event registrar: if an enhancer wishes to respond to various actions performed by users, it can specify follow-up actions."""),
"",_(u"""### A Few important things to remember before, during and after enhancer development"""),
"",_(u"""* Be sure to talk to users planning to use your enhancer. For vision enhancement providers, make sure the enhancements are indeed what users want."""),
_(u"""* Test your enhancers with many users to make sure it is working correctly."""),
"",_(u"""### Typical enhancer development steps"""),
"",_(u"""When writing enhancers such as vision enhancement providers, you may wish to follow the recommended steps for driver and global plugin development (planning, talking to users, user test, etc.). As these modules will affect NVDA experience globally (even when switching configuration profiles), make sure the enhancer does not degrade user experience for people not needing it."""),
"",_(u"""## Sharing your add-on and experience with others"""),
"",_(u"""Once you've finished developing your add-ons, you might want to share your code with others. Along the way, you might contribute your know-how so others may benefit from your experiences."""),
"",_(u"""This chapter is designed to give some guidance on add-on release and maintenance, as well as connecting with your add-on users and other NVDA core and add-on developers around the world."""),
"",_(u"""### The NVDA Add-ons list"""),
"",_(u"""If you want to keep in touch with your add-on users or want to learn from or contribute your add-on to others, please subscribe to [NVDA add-ons list][4]. This is a low traffic list devoted to discussing current and future add-ons, as well as to review other add-ons created by members of the community or have your add-on reviewed by other add-on developers around the world."""),
"",_(u"""### The NVDA Community Add-ons web site and code repository"""),
"",_(u"""To download or learn more about various add-ons created by NVDA users, visit [NVDA Community Add-ons web site]. You can browse currently available add-ons, view add-ons under development and read add-on development guidelines."""),
"",_(u"""For developers wishing to read the code that powers various add-ons, you can search for add-on repositories stored on [GitHub]. The NVDA community add-on developers use [Git] for version control."""),
"",_(u"""Some of the useful and educational add-on repositories are:"""),
"",_(u"""* [Add-on Template]: this is the source code repository for the community add-on template."""),
_(u"""* [Place markers by Noelia Martinez](https://github.com/nvdaes/placeMarkers): adds place marker functionality and provides a good example of using text infos."""),
_(u"""* [Windows 10 App Essentials by Joseph Lee](https://github.com/josephsl/wintenApps): provides improved support for Windows 10 and various universal apps, considered a classic in how global plugins and app modules work together and includes examples of overlay classes and control behaviors that derives from UI Automation objects."""),
_(u"""* [Read Feeds by Noelia Martinez](https://github.com/nvdaes/readFeeds): eases discovery of feeds on various websites and includes a simple example of storing and validating add-on settings."""),
_(u"""* [NVDA Remote Support by Christopher Toth and Tyler Spivey](https://github.com/nvdaremote/nvdaremote): a popular add-on used for remote troubleshooting and technical support, provides examples of how various external Python libraries are used."""),
_(u"""* [StationPlaylist by Joseph Lee](https://github.com/josephsl/stationPlaylist): improves usage of StationPlaylist Studio, provides interesting examples on overlay classes and app API, use of threads, and add-on dialogs and other user interfaces."""),
"",_(u"""## Advanced Code Examples and Features"""),
"",_(u"""This chapter is a work in progress. If there is something you would like to see here, or if you have a comment or correction, please contact one of the maintainers."""),
"",_(u"""### Interactive Dialogs"""),
"",_(u"""#### Introduction"""),
"",_(u"""To present straight forward information to your users, ui.message and ui.browseableMessage are usually sufficient. However, if the user needs to give information back to your add-on, those aren't going to help. For that, you need dialogs. Creating dialogs and the many considerations around using them are outside the scope of this document, but we can help to get you started."""),
"",_(u"""To create and use dialogs, you need to import two modules: GUI (import gui) and WXPython (import wx). Read their documentation for the large number of options available to you."""),
"",_(u"""In short:"""),
_(u"""* gui provides methods for constructing and displaying some standard dialogs."""),
_(u"""* wx provides the actual implementation for those dialogs, and provides many of the constants and extended options you will need to really make use of dialogs effectively."""),
"",_(u"""#### Example 1: A Basic Dialog"""),
"",_(u"""The following code will create a basic dialog, providing the user with two very familiar options. See the notes after the code to understand what is going on."""),
"",_(u"""```python"""),
_(u"""import globalPluginHandler"""),
_(u"""from scriptHandler import script"""),
"",_(u"""class GlobalPlugin (globalPluginHandler.GlobalPlugin):"""),
"",_(u"""	@script(gesture=\"kb:nvda+shift+t\")		# Configure the key"""),
_(u"""	def script_makeSillyWindow(self, gesture):	# A normal GlobalPlugin script method"""),
_(u"""		import wx				# We need this for working with dialogs and windows"""),
_(u"""		import gui				# We need this for working with dialogs and windows"""),
"",_(u"""		def showSillyWindow():			# Define an internal function"""),
_(u"""			gui.messageBox(\"Warning! You are about to do nothing. But you will be doing it with an important looking dialog window. Continue?\","""),
_(u"""				\"Silly Question Window\", wx.OK | wx.CANCEL | wx.ICON_WARNING)"""),
_(u"""		wx.CallAfter(showSillyWindow)"""),
_(u"""```"""),
"",_(u"""If you save the above as a global plugin and load it in NVDA, then press NVDA+shift+t, you should find yourself in a new window."""),
_(u"""The window is generated by the call to gui.messageBox. The first parameter is the text of the window, the second parameter is the title of the window, and the third parameter contains a list of constant flags which wx uses to generate the dialog's buttons and other attributes."""),
_(u"""* wx.ICON_WARNING, causes the window to behave as a Windows warning."""),
_(u"""* wx.OK, causes the window to display the standard OK button."""),
_(u"""* And wx.CANCEL is the same for cancel."""),
"",_(u"""Unfortunately, if we just call gui.messageBox directly, it will usually cause NVDA to hang, unless it is run from the main thread. To get around that problem, we use wx.CallAfter to queue the dialog for display in the main thread. However, wx.CallAfter can not call gui.messageBox directly: it must do so through some other method or function. In this example we achieve that by using a nested function the only purpose of which is the one-time generation of that dialog."""),
"",_(u"""#### Example 2: A Three-Way Dialog"""),
"",_(u"""Below is a more complex example, that shows how to return information from a dialog, based upon which button was pressed. Note that there are many more constants you can use, and types of dialog other than messageBox. This section is only an introduction to the subject to get you started."""),
"",_(u"""```python"""),
_(u"""import globalPluginHandler, wx, gui"""),
_(u"""from scriptHandler import script"""),
_(u"""import gui"""),
_(u"""import wx"""),
"",_(u"""class GlobalPlugin (globalPluginHandler.GlobalPlugin):"""),
"",_(u"""	@script(gesture=\"kb:nvda+shift+t\")		# Configure the key"""),
_(u"""	def script_askPointlessQuestion(self, gesture):"""),
_(u"""		def askTheQuestion():			# Define an internal function"""),
_(u"""			result = gui.messageBox(\"\"\"Warning! You are about to answer a pointless question."""),
_(u"""Fortunately you have this great window to do it in!"""),
_(u"""Do you wish to proceed?\"\"\","""),
_(u"""				\"Silly Question\", wx.YES_NO | wx.NO_DEFAULT | wx.CANCEL)"""),
_(u"""			if result == wx.YES: answer = \"yes\""""),
_(u"""			elif result == wx.NO: answer = \"no\""""),
_(u"""			else: return"""),
_(u"""			gui.messageBox(\"You answered %s to the pointless question.\" %(answer), \"Silly Answer\", wx.OK)"""),
_(u"""		wx.CallAfter(askTheQuestion)"""),
_(u"""```"""),
"",_(u"""### Using The Log"""),
"",_(u"""**Coming soon**"""),
"",_(u"""### Threading"""),
"",_(u"""#### Introduction"""),
"",_(u"""If a routine in an add-on runs for a long time, NVDA would appear to freeze or stop responding altogether. This is where threads come in - running a long-running task with a different thread, allowing NVDA to remain responsive."""),
"",_(u"""Although Python does support threads, it can run one thing at a time due to global interpreter lock (GIL). Thus, on computers with multiple processor cores, it is advised to use processes (via multiprocessing module) to allow Python interpreters to run on all cores. However, this workaround introduces latency and overhead, so for many scenarios, threads are preferred."""),
"",_(u"""#### Threading scenarios"""),
"",_(u"""Threads are useful if"""),
"",_(u"""* You need to work on something while waiting for a result. For example, if a global plugin needs to access the internet for various tasks, a separate thread can be used for obtaining online information while NVDA is busy with something else."""),
_(u"""* Monitor things in the background without interrupting NVDA. For example, an overlay class defined in an app module can use a thread to announce screen information as it changes in the background."""),
_(u"""* Run tasks periodically. For example, a speech synthesizer can use a timer thread to determine if a hardware synthesizer is ready or not."""),
"",_(u"""#### Threading examples"""),
"",_(u"""All examples use threading module unless noted otherwise."""),
"",_(u"""Download content from a website via a global plugin:"""),
"",_(u"""	import threading"""),
_(u"""	import urllib"""),
_(u"""	# Other parts of the global plugin."""),
"",_(u"""	def downloadContent(address):"""),
_(u"""		return urllib.urlopen(address)"""),
"",_(u"""	class GlobalPlugin(globalPluginHandler.GlobalPlugin):"""),
"",_(u"""		def script_downloadContent(self, gesture):"""),
_(u"""			downloadThread = threading.Thread(target=downloadContent, args=(someWebsite,))"""),
_(u"""			downloadThread.start()"""),
_(u"""			downloadThread.join()"""),
"",_(u"""We need to use a separate thread to access web content because urllib (urllib.request in Python 3) blocks, making NVDA appear to freeze."""),
"",_(u"""Announce a message ten seconds after pressing a key from an app:"""),
"",_(u"""There are two timers you can use: threading.Timer or wx.Timer. The below app module example uses threading.Timer."""),
"",_(u"""	import threading"""),
_(u"""	import ui"""),
_(u"""	# Other parts of an app module."""),
"",_(u"""	class AppModule(appModuleHandler.AppModule):"""),
"",_(u"""		def script_saySomething(self, gesture):"""),
_(u"""			messageTimer = threading.Timer(10.0, ui.message, args=\"this is a timer message\", ))"""),
_(u"""			messageTimer.start()"""),
"",_(u"""One limitation with threading.Timer is that it does not support repetitive tasks, and for these, you need to use wx.Timer."""),
"",_(u"""### Storing and Using Persistent Information Outside Your Add-on"""),
"",_(u"""**Coming Soon**"""),
"",_(u"""## Miscellaneous information"""),
"",_(u"""Please add additional material to this guide. We at NVDA Add-on Team welcome contributions from other add-on developers and users around the world."""),
"",_(u"""## Appendices"""),
"",_(u"""### Appendix A: add-on terms dictionary"""),
"",_(u"""The below terms are used throughout this development guide as well as in the add-ons community to refer to add-ons, development processes and so on."""),
"",_(u"""* Add-on: an extension for a program. In NVDA world, add-ons refer to additional packages users can install to extend NVDA's functionality, improve support for an app, or add new speech synthesizers or braille displays."""),
_(u"""* Application: synonymous with program."""),
_(u"""* App module: a module that adds or improves support for a program."""),
_(u"""* API: Application Programming Interface."""),
_(u"""* Base class: parent class of an object."""),
_(u"""* Braille display: a hardware or software that outputs text via tactile braille output and/or allows users to enter text via a braille keyboard or other input mechanisms."""),
_(u"""* Built-in module: a module that comes with NVDA that add-ons can optionally override or extend."""),
_(u"""* Caret: cursor shown on screen, usually seen when editing text or navigating documents."""),
_(u"""* Class: definition of an object."""),
_(u"""* Driver: a program that allows another program to talk to other software or hardware."""),
_(u"""* Enhancer: a module that adds usability enhancements in tandem with NVDA."""),
_(u"""* Event: a routine called when certain things happen such as character input, changes to text on screen, a checkbox being checked and so on."""),
_(u"""* Function: a piece of code that performs something given one or more input parameters and optionally returns something."""),
_(u"""* Gesture: a piece of input such as key presses, touchscreen flicks, braille keys and so on."""),
_(u"""* Global plugin: a module that adds features everywhere."""),
_(u"""* Module: collection of variables, functions, classes and others inside a file."""),
_(u"""* Object: a class definition coming to life."""),
_(u"""* Script: a function that is attached (assigned) to a gesture."""),
_(u"""* Speech synthesizer: a software or hardware that converts text and various speech commands sent to it into voice output."""),
_(u"""* Variable: a temporary placeholder for some data."""),
"",_(u"""### Appendix B: Programming and Python concepts every add-on developer needs to know"""),
"",_(u"""The below list summarizes concepts all add-on developers will need to know when writing add-ons."""),
"",_(u"""* API: a set of documentation and code samples used to let a program or hardware interface with other software or hardware."""),
_(u"""* Base class: a class that provides base methods, attributes and properties for other objects to inherit and extend. Synonymous with superclass and parent class."""),
_(u"""* Child class: a class that derives its power from one or more base classes."""),
_(u"""* Class: definition of objects, including methods, attributes and expected behaviors. All Python classes and attributes are public; they can \"become private\" through use of naming conventions such as prefixing a variable name with underscores (_)."""),
_(u"""* Code block: collection of code."""),
_(u"""* Compiling: translating a high-level programming language into a low-level language suitable for machine execution."""),
_(u"""* Event-driven programming: a programming paradigm based on following, reacting to and handling events."""),
_(u"""* Exception: one or more runtime circumstances that prevent normal operation of a program such as being denied access to a resource, name usage problem in code and other cases."""),
_(u"""* GUI: Graphical User Interface."""),
_(u"""* Handle: an opaque reference to a resource such as a file, TCP socket, window and so on."""),
_(u"""* Has versus is relationship: former referring to attributes of a single class, the latter referring to inherited classes."""),
_(u"""* Indentation-based syntax: use of indentations such as tabs to denote code blocks."""),
_(u"""* Inheritance: ability for one or more parent classes to provide base methods and attributes for child classes to override or extend as the need arises."""),
_(u"""* Interpreting: running a program written in a high-level language without compiling it first."""),
_(u"""* Object: runtime instance of one or more classes."""),
_(u"""* Object hierarchy: how screen elements are organized via parent-child (container-contained) relationship."""),
_(u"""* Object-oriented programming: a programming paradigm that defines solutions to problems or represent real-life things via classes and objects."""),
_(u"""* Scope: where variables, functions, classes and objects are defined in code."""),
"",_(u"""### Appendix C: Add-on type comparison"""),
"",_(u"""The following table compares various add-on types and when to use them."""),
"",_(u"""| Task or feature | Global plugin | App module | Driver | Enhancer |"""),
_(u"""| ------- | --------- | -------- | -------- | -------- |"""),
_(u"""| Can be used everywhere | Yes | No | Yes | Yes |"""),
_(u"""| Naming restrictions | No (limited by Windows file naming conventions) | Must be name of the executable | No (limited by Windows file naming conventions) | No (limited by Windows file naming conventions) |"""),
_(u"""| Retrieve various controls, including focused control | Yes | Yes | No | Yes |"""),
_(u"""| Commands can be used everywhere | Yes | No | Braille display drivers only if defined | Yes |"""),
_(u"""| Handle events such as focus changes | Yes | Yes | No | Yes |"""),
_(u"""| Define custom objects to represent controls | Yes | Yes | No | No |"""),
_(u"""| Define custom actions to be performed when the module loads and unloads | Yes | Yes | Yes | Yes |"""),
_(u"""| Perform actions when profile switching occurs and other actions | Yes | Yes | Yes | Yes |"""),
_(u"""| Can modify object attributes at runtime | No | Yes | No | No |"""),
_(u"""| Modify speech and other output routines and presentation experience (i.e. speech.cancelSpeech, braille.handler.update, etc.) | Yes | yes | No | Depends on enhancer |"""),
_(u"""| Include custom settings | Yes | Yes | Yes | Yes |"""),
_(u"""| Can patch NVDA functions, classes and modules at will | Yes | Not advised | No | Not advised |"""),
_(u"""| Subject to configuration profile switches | No | Yes | Yes | Yes |"""),
_(u"""| Can call external libraries written in C and other languages and bundled as DLLs | Yes | Yes | Yes | Yes |"""),
"",_(u"""### Appendix D: notes and references for scripters of other screen readers"""),
"",_(u"""If you write scripts for screen readers such as JAWS for Windows or Window-Eyes, be sure to go over this section as it introduces you to common tasks you can do with NVDA and other notes."""),
"",_(u"""| Task | NVDA or Python function/class/module | Notes |"""),
_(u"""| -------- | -------- | -------- |"""),
_(u"""| Cancel speech | speech.cancelSpeech() | Stops speech. |"""),
_(u"""| Speak something | speech.speakMessage(message) or as part of ui.message(message) | the ui.message function also performs braille output. |"""),
_(u"""| Braille something | braille.handler.message(message) or ui.message(message) | Same as above. |"""),
_(u"""| Show an HTML window | ui.browseableMessage(message, title, isHTML = True) | Mimics virtual viewer except it'll be shown on screen. |"""),
_(u"""| Retrieve focused object | something = api.getFocusObject() | |"""),
_(u"""| Retrieve foreground window | foreground = api.getForegroundObject() |  |"""),
_(u"""| Title of the active window (if present) | foreground.name | |"""),
_(u"""| Find out what object is navigator object | obj = api.getNavigatorObject() | This may or may not be the focused control. |"""),
_(u"""| Retrieve window handle for a given object | hwnd = obj.windowHandle | Obtain object via api.get*Object() functions. |"""),
_(u"""| Check the name of the window class | obj.windowClassName == somename | |"""),
_(u"""| Making sure the parent object has the correct window control ID | if obj.parent.windowControlID == something: statement | |"""),
_(u"""| The parent object does not provide what I want, but the grandparent does | something = obj.parent.parent.attribute | |"""),
_(u"""| The label of a list item is the name of its first child object | obj.name = obj.firstChild.name | |"""),
_(u"""| I want the control label of the focused object and description of the previous object to be announced when I press NVDA+Tab | In reportFocus(self): obj.name += \" \" + obj.previous.description | |"""),
_(u"""| Announce state changes if and only if the next object is the toolbar I'm looking for | In event_stateChange(self): toolbar = obj.next; if toolbar.role == controlTypes.ROLE_TOOLBAR and toolbar.attribute = whatYouAreLookingFor and additional conditions ...: statement | For better readability, place each statement on separate lines with correct indents applied. |"""),
_(u"""| Announcing the name of an object on screen (provided that object navigation can be used) | obj = api.getForegroundObject().route...; ui.message(obj.name) | Try placing each statement on its own line with correct indents applied. Route refers to obj.next/previous/parent/firstChild/lastChild/children[index]/getChild(index) and so on. |"""),
_(u"""| Check if the object's role is what you want | obj.role == controlTypes.ROLE_* | ROLE_* can be any role you are looking for. |"""),
_(u"""| Looking for a specific text in the object's name | sometext in obj.name | This is a typical string membership task. |"""),
_(u"""| Does the control's label start with a specific text | obj.name.startswith(sometext) | |"""),
_(u"""| Length of a text field with easily retrievable value | len(obj.value) | This works if the value of the field can be found. |"""),
_(u"""| Is a checkbox checked | controlTypes.STATE_CHECKED in obj.states | obj.states is a set. First, verify that the role is a checkbox. |"""),
_(u"""| How many items are in a list | someList.childCount | Provided that the list provides correct underlying implementation to obtain item count. |"""),
_(u"""| Where the object is located on screen | obj.location | This returns a tuple of four elements, namely x and y coordinates of the top-left corner of the object, as well as length and width. For example, on the Shell (desktop) object with screen resolution of 1920 by 1080 pixels, the return value will be (0, 0, 1920, 1080. |"""),
_(u"""| Is this an MSAA control | isinstance(obj, NVDAObjects.IAccessible.IAccessible) | A typical implementation is to import IAccessible from NVDAObjects.IAccessible and doing isinstance(obj, IAccessible). |"""),
_(u"""| Position of a MSAA list item | item.IAccessibleChildID | Provided that this is properly implemented. The default for controls other than list items, treeview items and what not is 0. |"""),
_(u"""| I need to work with IAccessible object methods directly | obj.IAccessibleObject.method | First, find out how to use the given MSAA method for a control, then retrieve the IAccessible object itself and call the needed method. |"""),
_(u"""| Give me the UIA element that powers a certain UIA control | obj.UIAElement | Useful if you wish to perform UIA client operations on this element. |"""),
_(u"""| Automation ID for a UIA element | obj.UIAElement.cachedAutomationID | First, check if the object is a UIA control . |"""),
_(u"""| Framework used to generate this UIA object | obj.UIAElement.cachedFrameworkID | The GUI framework used to program this object. Commonly encountered frameworks are Direct UI, Windows Presentation Foundation (WPF) controls with UIA enabled, XAML (eXtensible Application Programming Language) and Microsoft Edge. |"""),
_(u"""| I want to ask UIA about values of a specific property | obj._getUIACacheablePropertyValue(propertyID) | Provided that the object is a UIA control, pass in the property ID you wish to know as an argument to this function. If the property is supported, a valid value will be returned, otherwise a COM error exception will be thrown. |"""),
_(u"""| Executable name of any object | obj.appModule.appName | appModule is the attribute of any object that can be represented within an app such as focused control. |"""),
_(u"""| Send keystrokes | gesture.send() | This is to be called from a script with the desired keystroke bound to it. |"""),
_(u"""| Handling multiple presses of a keystroke | scriptHandler.getLastScriptRepeatCount() | 0 means the command was pressed once. |"""),
_(u"""| I want to assign Control+Alt+number row to a script | In initOverlayClass(self): for key in range(10): self.bindGesture(\"control+alt+%s\"%(key), \"somescript\") | For Python 2, use xrange instead. For ease of readability, indent each statement on separate lines. |"""),
_(u"""| providing input help message | script_somescript.__doc__ | Effectively, a script's docstring is treated as its input help message. |"""),
_(u"""| Handle name changes | event_nameChange(self, obj, nextHandler) | The body should consist of what should be done, ending with a call -to nextHandler() function. |"""),
_(u"""| Live region change announcements | event_liveRegionChange(self, obj, nextHandler) | By default, new text will be spoken and/or brailled. |"""),
_(u"""| Instantly transform a window into a dialog | In chooseNVDAObjectOverlayClasses(self, obj, clsList): if you found the window you want: clsList.insert(0, NVDAObjects.Behaviors.Dialog) | Be sure to identify this window that is really a dialog. If done correctly, contents of this \"dialog\" will be announced automatically. |"""),
_(u"""| I'm working with a terminal window | Inherit from NVDAObjects.behaviors.Terminal | |"""),
_(u"""| I want to add table navigation commands for an object that is not shown as a table yet | Inherit from NVDAObjects.behaviors.RowWithFakeNavigation | This class defines input help mode message and a base implementation for table navigation commands (Control+Alt+arrows). |"""),
_(u"""| I need pointers for providing improved support for a Java application | NVDAObjects.JAB and JABHandler module | Java Access Bridge (32-bit and 64-bit) should be installed (installed in 2019.3). |"""),
_(u"""| Adding support for an app that has similar functionality as another app | Import contents of the source app module via from appModuleName import * | Commonly called \"aliasing\". |"""),
_(u"""| Play a tone | tones.beep(hertz, duration) | Duration in milliseconds. |"""),
_(u"""| Play a tone on the left speaker | tones.beep(hertz, duration, leftVolume=100, rightVolume=0) | |"""),
_(u"""| Play a wave file | nvwave.playWaveFile(path) | For example, nvwave.playWaveFile(r\"test.wav\") |"""),
_(u"""| Obtain text info for a given object | obj.TextInfo | Note the uppercase \"T\". |"""),
_(u"""| Check if keyboard echo (typed characters) is on | config.conf[\"keyboard\"][\"speakTypedCharacters\"] | |"""),
_(u"""| turn speak command keys on without opening a settings dialog | config.conf[\"keyboard\"][\"speakCommandKeys\"] = True | The user should toggle this on via keyboard settings dialog. |"""),
_(u"""| Is focus mode/forms mode active | obj.treeInterceptor.passThrough | If True, focus/forms mode is on while using browse mode documents. |"""),
_(u"""| Is touchscreen support available | touchHandler.handler is not None | If it is not None, touch support is active and available. |"""),
_(u"""| Get NVDA version | versionInfo.version | |"""),
_(u"""| I wish to do something whenever configuration profiles are changed | config.post_configProfileSwitch | You need to register a function to listen to this action, then let this function do something when profiles are changed. |"""),
_(u"""| Let me know if this is a snapshot build | __debug__ | If yes (True), this is a snapshot build, otherwise this is a release version. |"""),
_(u"""| I need certain features in order for my code to work better | hasattr(module, something) | This allows you to check for existence of a feature/attribute you need, as it then allows you to support old and new code paths. |"""),
_(u"""| Windows version | sys.getwindowsversion | This returns a tuple of five elements: major version, minor version, build number, platform, and service pack version. |"""),
_(u"""| Is 64-bit Windows | os.environ[\"PROCESSOR_ARCHITEW6432\"] in (\"AMD64\", \"ARM64\") or os.path.exists(r\"C:\\Program Files (X86) | The environment variable method is more reliable. Starting from 2017.4, both AMD64 or ARM64 must be checked, especially when supporting Windows 10 on ARM. |"""),
_(u"""| Registry access | winreg module | \"_winreg\" in Python 2. |"""),
_(u"""| Open a website with the default web browser | os.startfile(URL) | |"""),
_(u"""| Download headers for a file on the web | resource = urllib.urlopen(URL) | |"""),
_(u"""| Work with JSON data | json module | |"""),
_(u"""| Allocate some memory somewhere | ctypes.windll.kernel32.VirtualAllocEx() | The faster way to do this is winKernel.virtualAllocEx function. |"""),
_(u"""| Send a message to another process | ctypes.windll.user32.SendMessageW() | The shorter way is winUser.sendMessage() function. |"""),
_(u"""| Current time in seconds | time.time() | This returns seconds elapsed from January 1, 1970 at midnight. |"""),
_(u"""| Create a message box | gui.messageBox | A thin wrapper around wx.MessageBox class. |"""),
_(u"""| Create a custom dialog | wx.Dialog | |"""),
_(u"""| Run multiple background tasks at once | threading.Thread | In reality, due to internal issues, Python will run one thread after another. This approach is useful if you want to run a background task while making NVDA remain responsive. |"""),
_(u"""| Run something periodically | wx.PyTimer or threading.Timer | |"""),
_(u"""| Tally occurrence of text in a document | collections.Counter | Be sure to have a list of words from a text file before running a tally on it. |"""),
_(u"""| Create a dynamic array | list object | Python's list object ([]) is a dynamic array. |"""),
_(u"""| Work with associative arrays | dict object | Python's dictionary ({}) object is another name for associative array, sometimes called a map. |"""),
_(u"""| Open, parse, and save config files | config module or configobj module | |"""),
_(u"""| I wish to make my code run faster and error-free | DO NOT DO IT UNLESS YOU REALLY NEED TO! | To paraphrase a quote from a famous programmer, \"don't optimize unless you want to go through headaches\". |"""),
_(u"""| I want to release version 1.0 of my code with everything included | NEVER DO THAT UNLESS YOU KNOW WHY,  know WHAT YOU ARE DOING, OR SPECIFIED BY A CONTRACT YOU SIGNED! | |"""),
_(u"""| I wish to bring a feature from another screen reader to NVDA | Justify why and plan accordingly | |"""),
_(u"""| I want to contribute features of my add-on to NVDA screen reader | Send in a pull request and prepare to answer questions from reviewers | Sometimes, a feature or two from an add-on do land in NVDA screen reader but after going through pull request review process. For more information, see NV Access's contributing guidelines. |"""),
"",_(u"""### Appendix E: Python 2 versus 3"""),
"",_(u"""The following describes notable changes between Python 2 and 3 and tips for making your add-on Python 2 and 3 compatible."""),
"",_(u"""| Concept or task | Python 2| Python 3 | Compatibility tips |"""),
_(u"""| ------- | --------- | -------- | -------- |"""),
_(u"""| Print text | print text | print(text) | The latter also works on Python 2. |"""),
_(u"""| Default text format | ANSI | Unicode | Unicode is preferred. To do so, prefix text with a \"u\". |"""),
_(u"""| Range | xrange | range | If you are not concerned with performance, use range. |"""),
_(u"""| Reduce/accumulate | reduce | functools.reduce | |"""),
_(u"""| Map and filter returns | list | iterator | If you want maximum compatibility, wrap a call to map or filter inside a list function call. |"""),
_(u"""| Exception aliasing | exception, e | exception as e | The latter works on Python 2. |"""),
_(u"""| Relative import | import relativeModule | from . import relativeModule | The latter also works on Python 2. |"""),
_(u"""| Registry access | _winreg | winreg | For maximum compatibility, use winreg, and on Python 2, import _winreg as winreg. |"""),
_(u"""| Dictionary item/key/value iteration | dict.iteritems/iterkeys/itervalues | dict.items/keys/values | In case of dict.keys, one can just iterate through the dictionary itself. |"""),
_(u"""| Strictly integer division | / | // | The former now performs regular division on Python 3. |"""),
_(u"""| Class definition | class someclass: content | class someclass(object): content | The latter also works on Python 2. |"""),
]